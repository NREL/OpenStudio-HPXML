<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>
  Class: HPXMLTranslatorTest
  
    &mdash; Documentation by YARD 0.9.16
  
</title>

  <link rel="stylesheet" href="css/style.css" type="text/css" charset="utf-8" />

  <link rel="stylesheet" href="css/common.css" type="text/css" charset="utf-8" />

<script type="text/javascript" charset="utf-8">
  pathId = "HPXMLTranslatorTest";
  relpath = '';
</script>


  <script type="text/javascript" charset="utf-8" src="js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="js/app.js"></script>


  </head>
  <body>
    <div class="nav_wrap">
      <iframe id="nav" src="class_list.html?1"></iframe>
      <div id="resizer"></div>
    </div>

    <div id="main" tabindex="-1">
      <div id="header">
        <div id="menu">
  
    <a href="_index.html">Index (H)</a> &raquo;
    
    
    <span class="title">HPXMLTranslatorTest</span>
  
</div>

        <div id="search">
  
    <a class="full_list_link" id="class_list_link"
        href="class_list.html">

        <svg width="24" height="24">
          <rect x="0" y="4" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="12" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="20" width="24" height="4" rx="1" ry="1"></rect>
        </svg>
    </a>
  
</div>
        <div class="clear"></div>
      </div>

      <div id="content"><h1>Class: HPXMLTranslatorTest
  
  
  
</h1>
<div class="box_info">
  
  <dl>
    <dt>Inherits:</dt>
    <dd>
      <span class="inheritName">MiniTest::Test</span>
      
        <ul class="fullTree">
          <li>Object</li>
          
            <li class="next">MiniTest::Test</li>
          
            <li class="next">HPXMLTranslatorTest</li>
          
        </ul>
        <a href="#" class="inheritanceTree">show all</a>
      
    </dd>
  </dl>
  

  
  
  
  
  

  

  
  <dl>
    <dt>Defined in:</dt>
    <dd>tests/hpxml_translator_test.rb</dd>
  </dl>
  
</div>








  
    <h2>
      Instance Method Summary
      <small><a href="#" class="summary_toggle">collapse</a></small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#_get_results-instance_method" title="#_get_results (instance method)">#<strong>_get_results</strong>(rundir, sim_time, workflow_time)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#_rm_path-instance_method" title="#_rm_path (instance method)">#<strong>_rm_path</strong>(path)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#_run_xml-instance_method" title="#_run_xml (instance method)">#<strong>_run_xml</strong>(xml, this_dir, args)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#_test_dse-instance_method" title="#_test_dse (instance method)">#<strong>_test_dse</strong>(xmls, hvac_dse_dir, all_results)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#_test_multiple_hvac-instance_method" title="#_test_multiple_hvac (instance method)">#<strong>_test_multiple_hvac</strong>(xmls, hvac_multiple_dir, all_results)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#_test_partial_hvac-instance_method" title="#_test_partial_hvac (instance method)">#<strong>_test_partial_hvac</strong>(xmls, hvac_partial_dir, all_results)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#_test_schema_validation-instance_method" title="#_test_schema_validation (instance method)">#<strong>_test_schema_validation</strong>(this_dir, xml)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#_test_simulation-instance_method" title="#_test_simulation (instance method)">#<strong>_test_simulation</strong>(args, this_dir, rundir)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#_verify_simulation_outputs-instance_method" title="#_verify_simulation_outputs (instance method)">#<strong>_verify_simulation_outputs</strong>(rundir, hpxml_path, results)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#_write_summary_results-instance_method" title="#_write_summary_results (instance method)">#<strong>_write_summary_results</strong>(results_dir, results)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#test_simulations-instance_method" title="#test_simulations (instance method)">#<strong>test_simulations</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
    </ul>
  


  

  <div id="instance_method_details" class="method_details_list">
    <h2>Instance Method Details</h2>

    
      <div class="method_details first">
  <h3 class="signature first" id="_get_results-instance_method">
  
    #<strong>_get_results</strong>(rundir, sim_time, workflow_time)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'tests/hpxml_translator_test.rb', line 78</span>

<span class='kw'>def</span> <span class='id identifier rubyid__get_results'>_get_results</span><span class='lparen'>(</span><span class='id identifier rubyid_rundir'>rundir</span><span class='comma'>,</span> <span class='id identifier rubyid_sim_time'>sim_time</span><span class='comma'>,</span> <span class='id identifier rubyid_workflow_time'>workflow_time</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_sql_path'>sql_path</span> <span class='op'>=</span> <span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_join'>join</span><span class='lparen'>(</span><span class='id identifier rubyid_rundir'>rundir</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>eplusout.sql</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
  <span class='id identifier rubyid_sqlFile'>sqlFile</span> <span class='op'>=</span> <span class='const'>OpenStudio</span><span class='op'>::</span><span class='const'>SqlFile</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='id identifier rubyid_sql_path'>sql_path</span><span class='comma'>,</span> <span class='kw'>false</span><span class='rparen'>)</span>

  <span class='id identifier rubyid_tdws'>tdws</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>TabularDataWithStrings</span><span class='tstring_end'>&#39;</span></span>
  <span class='id identifier rubyid_abups'>abups</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>AnnualBuildingUtilityPerformanceSummary</span><span class='tstring_end'>&#39;</span></span>
  <span class='id identifier rubyid_ef'>ef</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Entire Facility</span><span class='tstring_end'>&#39;</span></span>
  <span class='id identifier rubyid_eubs'>eubs</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>End Uses By Subcategory</span><span class='tstring_end'>&#39;</span></span>
  <span class='id identifier rubyid_s'>s</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Subcategory</span><span class='tstring_end'>&#39;</span></span>

  <span class='comment'># Obtain fueltypes
</span>  <span class='id identifier rubyid_query'>query</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>SELECT ColumnName FROM </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_tdws'>tdws</span><span class='embexpr_end'>}</span><span class='tstring_content'> WHERE ReportName=&#39;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_abups'>abups</span><span class='embexpr_end'>}</span><span class='tstring_content'>&#39; AND ReportForString=&#39;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_ef'>ef</span><span class='embexpr_end'>}</span><span class='tstring_content'>&#39; AND TableName=&#39;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_eubs'>eubs</span><span class='embexpr_end'>}</span><span class='tstring_content'>&#39; and ColumnName!=&#39;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_s'>s</span><span class='embexpr_end'>}</span><span class='tstring_content'>&#39;</span><span class='tstring_end'>&quot;</span></span>
  <span class='id identifier rubyid_fueltypes'>fueltypes</span> <span class='op'>=</span> <span class='id identifier rubyid_sqlFile'>sqlFile</span><span class='period'>.</span><span class='id identifier rubyid_execAndReturnVectorOfString'>execAndReturnVectorOfString</span><span class='lparen'>(</span><span class='id identifier rubyid_query'>query</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_get'>get</span>

  <span class='comment'># Obtain units
</span>  <span class='id identifier rubyid_query'>query</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>SELECT Units FROM </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_tdws'>tdws</span><span class='embexpr_end'>}</span><span class='tstring_content'> WHERE ReportName=&#39;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_abups'>abups</span><span class='embexpr_end'>}</span><span class='tstring_content'>&#39; AND ReportForString=&#39;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_ef'>ef</span><span class='embexpr_end'>}</span><span class='tstring_content'>&#39; AND TableName=&#39;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_eubs'>eubs</span><span class='embexpr_end'>}</span><span class='tstring_content'>&#39; and ColumnName!=&#39;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_s'>s</span><span class='embexpr_end'>}</span><span class='tstring_content'>&#39;</span><span class='tstring_end'>&quot;</span></span>
  <span class='id identifier rubyid_units'>units</span> <span class='op'>=</span> <span class='id identifier rubyid_sqlFile'>sqlFile</span><span class='period'>.</span><span class='id identifier rubyid_execAndReturnVectorOfString'>execAndReturnVectorOfString</span><span class='lparen'>(</span><span class='id identifier rubyid_query'>query</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_get'>get</span>

  <span class='comment'># Obtain categories
</span>  <span class='id identifier rubyid_query'>query</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>SELECT RowName FROM </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_tdws'>tdws</span><span class='embexpr_end'>}</span><span class='tstring_content'> WHERE ReportName=&#39;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_abups'>abups</span><span class='embexpr_end'>}</span><span class='tstring_content'>&#39; AND ReportForString=&#39;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_ef'>ef</span><span class='embexpr_end'>}</span><span class='tstring_content'>&#39; AND TableName=&#39;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_eubs'>eubs</span><span class='embexpr_end'>}</span><span class='tstring_content'>&#39; AND ColumnName=&#39;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_s'>s</span><span class='embexpr_end'>}</span><span class='tstring_content'>&#39;</span><span class='tstring_end'>&quot;</span></span>
  <span class='id identifier rubyid_categories'>categories</span> <span class='op'>=</span> <span class='id identifier rubyid_sqlFile'>sqlFile</span><span class='period'>.</span><span class='id identifier rubyid_execAndReturnVectorOfString'>execAndReturnVectorOfString</span><span class='lparen'>(</span><span class='id identifier rubyid_query'>query</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_get'>get</span>
  <span class='comment'># Fill in blanks based on previous non-blank value
</span>  <span class='id identifier rubyid_full_categories'>full_categories</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>
  <span class='lparen'>(</span><span class='int'>0</span><span class='op'>..</span><span class='id identifier rubyid_categories'>categories</span><span class='period'>.</span><span class='id identifier rubyid_size'>size</span> <span class='op'>-</span> <span class='int'>1</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_i'>i</span><span class='op'>|</span>
    <span class='id identifier rubyid_full_categories'>full_categories</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_categories'>categories</span><span class='lbracket'>[</span><span class='id identifier rubyid_i'>i</span><span class='rbracket'>]</span>
    <span class='kw'>next</span> <span class='kw'>if</span> <span class='id identifier rubyid_full_categories'>full_categories</span><span class='lbracket'>[</span><span class='id identifier rubyid_i'>i</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_size'>size</span> <span class='op'>&gt;</span> <span class='int'>0</span>

    <span class='id identifier rubyid_full_categories'>full_categories</span><span class='lbracket'>[</span><span class='id identifier rubyid_i'>i</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_full_categories'>full_categories</span><span class='lbracket'>[</span><span class='id identifier rubyid_i'>i</span> <span class='op'>-</span> <span class='int'>1</span><span class='rbracket'>]</span>
  <span class='kw'>end</span>
  <span class='id identifier rubyid_full_categories'>full_categories</span> <span class='op'>=</span> <span class='id identifier rubyid_full_categories'>full_categories</span> <span class='op'>*</span> <span class='id identifier rubyid_fueltypes'>fueltypes</span><span class='period'>.</span><span class='id identifier rubyid_uniq'>uniq</span><span class='period'>.</span><span class='id identifier rubyid_size'>size</span> <span class='comment'># Expand to size of fueltypes
</span>
  <span class='comment'># Obtain subcategories
</span>  <span class='id identifier rubyid_query'>query</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>SELECT Value FROM </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_tdws'>tdws</span><span class='embexpr_end'>}</span><span class='tstring_content'> WHERE ReportName=&#39;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_abups'>abups</span><span class='embexpr_end'>}</span><span class='tstring_content'>&#39; AND ReportForString=&#39;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_ef'>ef</span><span class='embexpr_end'>}</span><span class='tstring_content'>&#39; AND TableName=&#39;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_eubs'>eubs</span><span class='embexpr_end'>}</span><span class='tstring_content'>&#39; AND ColumnName=&#39;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_s'>s</span><span class='embexpr_end'>}</span><span class='tstring_content'>&#39;</span><span class='tstring_end'>&quot;</span></span>
  <span class='id identifier rubyid_subcategories'>subcategories</span> <span class='op'>=</span> <span class='id identifier rubyid_sqlFile'>sqlFile</span><span class='period'>.</span><span class='id identifier rubyid_execAndReturnVectorOfString'>execAndReturnVectorOfString</span><span class='lparen'>(</span><span class='id identifier rubyid_query'>query</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_get'>get</span>
  <span class='id identifier rubyid_subcategories'>subcategories</span> <span class='op'>=</span> <span class='id identifier rubyid_subcategories'>subcategories</span> <span class='op'>*</span> <span class='id identifier rubyid_fueltypes'>fueltypes</span><span class='period'>.</span><span class='id identifier rubyid_uniq'>uniq</span><span class='period'>.</span><span class='id identifier rubyid_size'>size</span> <span class='comment'># Expand to size of fueltypes
</span>
  <span class='comment'># Obtain starting position of results
</span>  <span class='id identifier rubyid_query'>query</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>SELECT MIN(TabularDataIndex) FROM </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_tdws'>tdws</span><span class='embexpr_end'>}</span><span class='tstring_content'> WHERE ReportName=&#39;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_abups'>abups</span><span class='embexpr_end'>}</span><span class='tstring_content'>&#39; AND ReportForString=&#39;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_ef'>ef</span><span class='embexpr_end'>}</span><span class='tstring_content'>&#39; AND TableName=&#39;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_eubs'>eubs</span><span class='embexpr_end'>}</span><span class='tstring_content'>&#39; AND ColumnName=&#39;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_fueltypes'>fueltypes</span><span class='lbracket'>[</span><span class='int'>0</span><span class='rbracket'>]</span><span class='embexpr_end'>}</span><span class='tstring_content'>&#39;</span><span class='tstring_end'>&quot;</span></span>
  <span class='id identifier rubyid_starting_index'>starting_index</span> <span class='op'>=</span> <span class='id identifier rubyid_sqlFile'>sqlFile</span><span class='period'>.</span><span class='id identifier rubyid_execAndReturnFirstInt'>execAndReturnFirstInt</span><span class='lparen'>(</span><span class='id identifier rubyid_query'>query</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_get'>get</span>

  <span class='comment'># TabularDataWithStrings table is positional, so we access results by position.
</span>  <span class='id identifier rubyid_results'>results</span> <span class='op'>=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span>
  <span class='id identifier rubyid_fueltypes'>fueltypes</span><span class='period'>.</span><span class='id identifier rubyid_zip'>zip</span><span class='lparen'>(</span><span class='id identifier rubyid_full_categories'>full_categories</span><span class='comma'>,</span> <span class='id identifier rubyid_subcategories'>subcategories</span><span class='comma'>,</span> <span class='id identifier rubyid_units'>units</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_each_with_index'>each_with_index</span> <span class='kw'>do</span> <span class='op'>|</span><span class='lparen'>(</span><span class='id identifier rubyid_fueltype'>fueltype</span><span class='comma'>,</span> <span class='id identifier rubyid_category'>category</span><span class='comma'>,</span> <span class='id identifier rubyid_subcategory'>subcategory</span><span class='comma'>,</span> <span class='id identifier rubyid_fuel_units'>fuel_units</span><span class='rparen'>)</span><span class='comma'>,</span> <span class='id identifier rubyid_index'>index</span><span class='op'>|</span>
    <span class='kw'>next</span> <span class='kw'>if</span> <span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>District Cooling</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>District Heating</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_include?'>include?</span> <span class='id identifier rubyid_fueltype'>fueltype</span> <span class='comment'># Exclude ideal loads results
</span>
    <span class='id identifier rubyid_query'>query</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>SELECT Value FROM </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_tdws'>tdws</span><span class='embexpr_end'>}</span><span class='tstring_content'> WHERE ReportName=&#39;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_abups'>abups</span><span class='embexpr_end'>}</span><span class='tstring_content'>&#39; AND ReportForString=&#39;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_ef'>ef</span><span class='embexpr_end'>}</span><span class='tstring_content'>&#39; AND TableName=&#39;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_eubs'>eubs</span><span class='embexpr_end'>}</span><span class='tstring_content'>&#39; AND TabularDataIndex=&#39;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_starting_index'>starting_index</span> <span class='op'>+</span> <span class='id identifier rubyid_index'>index</span><span class='embexpr_end'>}</span><span class='tstring_content'>&#39;</span><span class='tstring_end'>&quot;</span></span>
    <span class='id identifier rubyid_val'>val</span> <span class='op'>=</span> <span class='id identifier rubyid_sqlFile'>sqlFile</span><span class='period'>.</span><span class='id identifier rubyid_execAndReturnFirstDouble'>execAndReturnFirstDouble</span><span class='lparen'>(</span><span class='id identifier rubyid_query'>query</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_get'>get</span>
    <span class='kw'>next</span> <span class='kw'>if</span> <span class='id identifier rubyid_val'>val</span> <span class='op'>==</span> <span class='int'>0</span>

    <span class='id identifier rubyid_results'>results</span><span class='lbracket'>[</span><span class='lbracket'>[</span><span class='id identifier rubyid_fueltype'>fueltype</span><span class='comma'>,</span> <span class='id identifier rubyid_category'>category</span><span class='comma'>,</span> <span class='id identifier rubyid_subcategory'>subcategory</span><span class='comma'>,</span> <span class='id identifier rubyid_fuel_units'>fuel_units</span><span class='rbracket'>]</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_val'>val</span>
  <span class='kw'>end</span>

  <span class='comment'># Disaggregate any crankcase and defrost energy from results (for DSE tests)
</span>  <span class='id identifier rubyid_query'>query</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>SELECT SUM(Value)/1000000000 FROM ReportData WHERE ReportDataDictionaryIndex IN (SELECT ReportDataDictionaryIndex FROM ReportDataDictionary WHERE Name=&#39;Cooling Coil Crankcase Heater Electric Energy&#39;)</span><span class='tstring_end'>&quot;</span></span>
  <span class='id identifier rubyid_sql_value'>sql_value</span> <span class='op'>=</span> <span class='id identifier rubyid_sqlFile'>sqlFile</span><span class='period'>.</span><span class='id identifier rubyid_execAndReturnFirstDouble'>execAndReturnFirstDouble</span><span class='lparen'>(</span><span class='id identifier rubyid_query'>query</span><span class='rparen'>)</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_sql_value'>sql_value</span><span class='period'>.</span><span class='id identifier rubyid_is_initialized'>is_initialized</span>
    <span class='id identifier rubyid_cooling_crankcase'>cooling_crankcase</span> <span class='op'>=</span> <span class='id identifier rubyid_sql_value'>sql_value</span><span class='period'>.</span><span class='id identifier rubyid_get'>get</span>
    <span class='kw'>if</span> <span class='id identifier rubyid_cooling_crankcase'>cooling_crankcase</span> <span class='op'>&gt;</span> <span class='int'>0</span>
      <span class='id identifier rubyid_results'>results</span><span class='lbracket'>[</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Electricity</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Cooling</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>General</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>GJ</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span><span class='rbracket'>]</span> <span class='op'>-=</span> <span class='id identifier rubyid_cooling_crankcase'>cooling_crankcase</span>
      <span class='id identifier rubyid_results'>results</span><span class='lbracket'>[</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Electricity</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Cooling</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Crankcase</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>GJ</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_cooling_crankcase'>cooling_crankcase</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
  <span class='id identifier rubyid_query'>query</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>SELECT SUM(Value)/1000000000 FROM ReportData WHERE ReportDataDictionaryIndex IN (SELECT ReportDataDictionaryIndex FROM ReportDataDictionary WHERE Name=&#39;Heating Coil Crankcase Heater Electric Energy&#39;)</span><span class='tstring_end'>&quot;</span></span>
  <span class='id identifier rubyid_sql_value'>sql_value</span> <span class='op'>=</span> <span class='id identifier rubyid_sqlFile'>sqlFile</span><span class='period'>.</span><span class='id identifier rubyid_execAndReturnFirstDouble'>execAndReturnFirstDouble</span><span class='lparen'>(</span><span class='id identifier rubyid_query'>query</span><span class='rparen'>)</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_sql_value'>sql_value</span><span class='period'>.</span><span class='id identifier rubyid_is_initialized'>is_initialized</span>
    <span class='id identifier rubyid_heating_crankcase'>heating_crankcase</span> <span class='op'>=</span> <span class='id identifier rubyid_sql_value'>sql_value</span><span class='period'>.</span><span class='id identifier rubyid_get'>get</span>
    <span class='kw'>if</span> <span class='id identifier rubyid_heating_crankcase'>heating_crankcase</span> <span class='op'>&gt;</span> <span class='int'>0</span>
      <span class='id identifier rubyid_results'>results</span><span class='lbracket'>[</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Electricity</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Heating</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>General</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>GJ</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span><span class='rbracket'>]</span> <span class='op'>-=</span> <span class='id identifier rubyid_heating_crankcase'>heating_crankcase</span>
      <span class='id identifier rubyid_results'>results</span><span class='lbracket'>[</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Electricity</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Heating</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Crankcase</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>GJ</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_heating_crankcase'>heating_crankcase</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
  <span class='id identifier rubyid_query'>query</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>SELECT SUM(Value)/1000000000 FROM ReportData WHERE ReportDataDictionaryIndex IN (SELECT ReportDataDictionaryIndex FROM ReportDataDictionary WHERE Name=&#39;Heating Coil Defrost Electric Energy&#39;)</span><span class='tstring_end'>&quot;</span></span>
  <span class='id identifier rubyid_sql_value'>sql_value</span> <span class='op'>=</span> <span class='id identifier rubyid_sqlFile'>sqlFile</span><span class='period'>.</span><span class='id identifier rubyid_execAndReturnFirstDouble'>execAndReturnFirstDouble</span><span class='lparen'>(</span><span class='id identifier rubyid_query'>query</span><span class='rparen'>)</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_sql_value'>sql_value</span><span class='period'>.</span><span class='id identifier rubyid_is_initialized'>is_initialized</span>
    <span class='id identifier rubyid_heating_defrost'>heating_defrost</span> <span class='op'>=</span> <span class='id identifier rubyid_sql_value'>sql_value</span><span class='period'>.</span><span class='id identifier rubyid_get'>get</span>
    <span class='kw'>if</span> <span class='id identifier rubyid_heating_defrost'>heating_defrost</span> <span class='op'>&gt;</span> <span class='int'>0</span>
      <span class='id identifier rubyid_results'>results</span><span class='lbracket'>[</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Electricity</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Heating</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>General</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>GJ</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span><span class='rbracket'>]</span> <span class='op'>-=</span> <span class='id identifier rubyid_heating_defrost'>heating_defrost</span>
      <span class='id identifier rubyid_results'>results</span><span class='lbracket'>[</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Electricity</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Heating</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Defrost</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>GJ</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_heating_defrost'>heating_defrost</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_sqlFile'>sqlFile</span><span class='period'>.</span><span class='id identifier rubyid_close'>close</span>

  <span class='id identifier rubyid_results'>results</span><span class='lbracket'>[</span><span class='ivar'>@simulation_runtime_key</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_sim_time'>sim_time</span>
  <span class='id identifier rubyid_results'>results</span><span class='lbracket'>[</span><span class='ivar'>@workflow_runtime_key</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_workflow_time'>workflow_time</span>

  <span class='kw'>return</span> <span class='id identifier rubyid_results'>results</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="_rm_path-instance_method">
  
    #<strong>_rm_path</strong>(path)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


887
888
889
890
891
892
893
894
895
896</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'tests/hpxml_translator_test.rb', line 887</span>

<span class='kw'>def</span> <span class='id identifier rubyid__rm_path'>_rm_path</span><span class='lparen'>(</span><span class='id identifier rubyid_path'>path</span><span class='rparen'>)</span>
  <span class='kw'>if</span> <span class='const'>Dir</span><span class='period'>.</span><span class='id identifier rubyid_exists?'>exists?</span><span class='lparen'>(</span><span class='id identifier rubyid_path'>path</span><span class='rparen'>)</span>
    <span class='const'>FileUtils</span><span class='period'>.</span><span class='id identifier rubyid_rm_r'>rm_r</span><span class='lparen'>(</span><span class='id identifier rubyid_path'>path</span><span class='rparen'>)</span>
  <span class='kw'>end</span>
  <span class='kw'>while</span> <span class='kw'>true</span>
    <span class='kw'>break</span> <span class='kw'>if</span> <span class='kw'>not</span> <span class='const'>Dir</span><span class='period'>.</span><span class='id identifier rubyid_exists?'>exists?</span><span class='lparen'>(</span><span class='id identifier rubyid_path'>path</span><span class='rparen'>)</span>

    <span class='id identifier rubyid_sleep'>sleep</span><span class='lparen'>(</span><span class='float'>0.01</span><span class='rparen'>)</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="_run_xml-instance_method">
  
    #<strong>_run_xml</strong>(xml, this_dir, args)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


67
68
69
70
71
72
73
74
75
76</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'tests/hpxml_translator_test.rb', line 67</span>

<span class='kw'>def</span> <span class='id identifier rubyid__run_xml'>_run_xml</span><span class='lparen'>(</span><span class='id identifier rubyid_xml'>xml</span><span class='comma'>,</span> <span class='id identifier rubyid_this_dir'>this_dir</span><span class='comma'>,</span> <span class='id identifier rubyid_args'>args</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_print'>print</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Testing </span><span class='embexpr_beg'>#{</span><span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_basename'>basename</span><span class='lparen'>(</span><span class='id identifier rubyid_xml'>xml</span><span class='rparen'>)</span><span class='embexpr_end'>}</span><span class='tstring_content'>...\n</span><span class='tstring_end'>&quot;</span></span>
  <span class='id identifier rubyid_rundir'>rundir</span> <span class='op'>=</span> <span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_join'>join</span><span class='lparen'>(</span><span class='id identifier rubyid_this_dir'>this_dir</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>run</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
  <span class='id identifier rubyid_args'>args</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>epw_output_path</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_absolute_path'>absolute_path</span><span class='lparen'>(</span><span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_join'>join</span><span class='lparen'>(</span><span class='id identifier rubyid_rundir'>rundir</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>in.epw</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_args'>args</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>osm_output_path</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_absolute_path'>absolute_path</span><span class='lparen'>(</span><span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_join'>join</span><span class='lparen'>(</span><span class='id identifier rubyid_rundir'>rundir</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>in.osm</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_args'>args</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>hpxml_path</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_xml'>xml</span>
  <span class='id identifier rubyid__test_schema_validation'>_test_schema_validation</span><span class='lparen'>(</span><span class='id identifier rubyid_this_dir'>this_dir</span><span class='comma'>,</span> <span class='id identifier rubyid_xml'>xml</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_results'>results</span> <span class='op'>=</span> <span class='id identifier rubyid__test_simulation'>_test_simulation</span><span class='lparen'>(</span><span class='id identifier rubyid_args'>args</span><span class='comma'>,</span> <span class='id identifier rubyid_this_dir'>this_dir</span><span class='comma'>,</span> <span class='id identifier rubyid_rundir'>rundir</span><span class='rparen'>)</span>
  <span class='kw'>return</span> <span class='id identifier rubyid_results'>results</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="_test_dse-instance_method">
  
    #<strong>_test_dse</strong>(xmls, hvac_dse_dir, all_results)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


769
770
771
772
773
774
775
776
777
778
779
780
781
782
783
784
785
786
787
788
789
790
791
792
793
794
795
796
797
798
799
800
801
802</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'tests/hpxml_translator_test.rb', line 769</span>

<span class='kw'>def</span> <span class='id identifier rubyid__test_dse'>_test_dse</span><span class='lparen'>(</span><span class='id identifier rubyid_xmls'>xmls</span><span class='comma'>,</span> <span class='id identifier rubyid_hvac_dse_dir'>hvac_dse_dir</span><span class='comma'>,</span> <span class='id identifier rubyid_all_results'>all_results</span><span class='rparen'>)</span>
  <span class='comment'># Compare 0.8 DSE heating/cooling results to 1.0 DSE results.
</span>  <span class='id identifier rubyid_xmls'>xmls</span><span class='period'>.</span><span class='id identifier rubyid_sort'>sort</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_xml'>xml</span><span class='op'>|</span>
    <span class='kw'>next</span> <span class='kw'>if</span> <span class='kw'>not</span> <span class='id identifier rubyid_xml'>xml</span><span class='period'>.</span><span class='id identifier rubyid_include?'>include?</span> <span class='id identifier rubyid_hvac_dse_dir'>hvac_dse_dir</span>
    <span class='kw'>next</span> <span class='kw'>if</span> <span class='kw'>not</span> <span class='id identifier rubyid_xml'>xml</span><span class='period'>.</span><span class='id identifier rubyid_include?'>include?</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>-dse-0.8</span><span class='tstring_end'>&quot;</span></span>

    <span class='id identifier rubyid_xml_dse80'>xml_dse80</span> <span class='op'>=</span> <span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_absolute_path'>absolute_path</span><span class='lparen'>(</span><span class='id identifier rubyid_xml'>xml</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_xml_dse100'>xml_dse100</span> <span class='op'>=</span> <span class='id identifier rubyid_xml_dse80'>xml_dse80</span><span class='period'>.</span><span class='id identifier rubyid_gsub'>gsub</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>-dse-0.8</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>-dse-1.0</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>

    <span class='id identifier rubyid_results_dse80'>results_dse80</span> <span class='op'>=</span> <span class='id identifier rubyid_all_results'>all_results</span><span class='lbracket'>[</span><span class='id identifier rubyid_xml_dse80'>xml_dse80</span><span class='rbracket'>]</span>
    <span class='id identifier rubyid_results_dse100'>results_dse100</span> <span class='op'>=</span> <span class='id identifier rubyid_all_results'>all_results</span><span class='lbracket'>[</span><span class='id identifier rubyid_xml_dse100'>xml_dse100</span><span class='rbracket'>]</span>
    <span class='kw'>next</span> <span class='kw'>if</span> <span class='id identifier rubyid_results_dse100'>results_dse100</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span>

    <span class='comment'># Compare results
</span>    <span class='id identifier rubyid_puts'>puts</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>\nResults for </span><span class='embexpr_beg'>#{</span><span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_basename'>basename</span><span class='lparen'>(</span><span class='id identifier rubyid_xml'>xml</span><span class='rparen'>)</span><span class='embexpr_end'>}</span><span class='tstring_content'>:</span><span class='tstring_end'>&quot;</span></span>
    <span class='id identifier rubyid_results_dse80'>results_dse80</span><span class='period'>.</span><span class='id identifier rubyid_keys'>keys</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_k'>k</span><span class='op'>|</span>
      <span class='kw'>next</span> <span class='kw'>if</span> <span class='kw'>not</span> <span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Heating</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Cooling</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_include?'>include?</span> <span class='id identifier rubyid_k'>k</span><span class='lbracket'>[</span><span class='int'>1</span><span class='rbracket'>]</span>
      <span class='kw'>next</span> <span class='kw'>if</span> <span class='kw'>not</span> <span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>General</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_include?'>include?</span> <span class='id identifier rubyid_k'>k</span><span class='lbracket'>[</span><span class='int'>2</span><span class='rbracket'>]</span> <span class='comment'># Exclude crankcase/defrost
</span>
      <span class='id identifier rubyid_result_dse80'>result_dse80</span> <span class='op'>=</span> <span class='id identifier rubyid_results_dse80'>results_dse80</span><span class='lbracket'>[</span><span class='id identifier rubyid_k'>k</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_to_f'>to_f</span>
      <span class='id identifier rubyid_result_dse100'>result_dse100</span> <span class='op'>=</span> <span class='id identifier rubyid_results_dse100'>results_dse100</span><span class='lbracket'>[</span><span class='id identifier rubyid_k'>k</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_to_f'>to_f</span>
      <span class='kw'>next</span> <span class='kw'>if</span> <span class='id identifier rubyid_result_dse80'>result_dse80</span> <span class='op'>==</span> <span class='float'>0.0</span> <span class='kw'>and</span> <span class='id identifier rubyid_result_dse100'>result_dse100</span> <span class='op'>==</span> <span class='float'>0.0</span>

      <span class='id identifier rubyid_dse_actual'>dse_actual</span> <span class='op'>=</span> <span class='id identifier rubyid_result_dse100'>result_dse100</span> <span class='op'>/</span> <span class='id identifier rubyid_result_dse80'>result_dse80</span>
      <span class='id identifier rubyid_dse_expect'>dse_expect</span> <span class='op'>=</span> <span class='float'>0.8</span>
      <span class='kw'>if</span> <span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_basename'>basename</span><span class='lparen'>(</span><span class='id identifier rubyid_xml'>xml</span><span class='rparen'>)</span> <span class='op'>==</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>valid-hvac-furnace-gas-room-ac-dse-0.8.xml</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>and</span> <span class='id identifier rubyid_k'>k</span><span class='lbracket'>[</span><span class='int'>1</span><span class='rbracket'>]</span> <span class='op'>==</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Cooling</span><span class='tstring_end'>&quot;</span></span>
        <span class='id identifier rubyid_dse_expect'>dse_expect</span> <span class='op'>=</span> <span class='float'>1.0</span> <span class='comment'># TODO: Generalize this
</span>      <span class='kw'>end</span>
      <span class='id identifier rubyid_puts'>puts</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>dse: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_dse_actual'>dse_actual</span><span class='period'>.</span><span class='id identifier rubyid_round'>round</span><span class='lparen'>(</span><span class='int'>2</span><span class='rparen'>)</span><span class='embexpr_end'>}</span><span class='tstring_content'> </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_k'>k</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
      <span class='id identifier rubyid_assert_in_delta'>assert_in_delta</span><span class='lparen'>(</span><span class='id identifier rubyid_dse_expect'>dse_expect</span><span class='comma'>,</span> <span class='id identifier rubyid_dse_actual'>dse_actual</span><span class='comma'>,</span> <span class='float'>0.022</span><span class='rparen'>)</span> <span class='comment'># TODO: Reduce tolerance
</span>    <span class='kw'>end</span>
    <span class='id identifier rubyid_puts'>puts</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>\n</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="_test_multiple_hvac-instance_method">
  
    #<strong>_test_multiple_hvac</strong>(xmls, hvac_multiple_dir, all_results)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


804
805
806
807
808
809
810
811
812
813
814
815
816
817
818
819
820
821
822
823
824
825
826
827
828
829
830
831
832
833
834
835
836
837
838
839
840
841
842</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'tests/hpxml_translator_test.rb', line 804</span>

<span class='kw'>def</span> <span class='id identifier rubyid__test_multiple_hvac'>_test_multiple_hvac</span><span class='lparen'>(</span><span class='id identifier rubyid_xmls'>xmls</span><span class='comma'>,</span> <span class='id identifier rubyid_hvac_multiple_dir'>hvac_multiple_dir</span><span class='comma'>,</span> <span class='id identifier rubyid_all_results'>all_results</span><span class='rparen'>)</span>
  <span class='comment'># Compare end use results for three of an HVAC system to results for one HVAC system.
</span>  <span class='id identifier rubyid_xmls'>xmls</span><span class='period'>.</span><span class='id identifier rubyid_sort'>sort</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_xml'>xml</span><span class='op'>|</span>
    <span class='kw'>next</span> <span class='kw'>if</span> <span class='kw'>not</span> <span class='id identifier rubyid_xml'>xml</span><span class='period'>.</span><span class='id identifier rubyid_include?'>include?</span> <span class='id identifier rubyid_hvac_multiple_dir'>hvac_multiple_dir</span>

    <span class='id identifier rubyid_xml_x3'>xml_x3</span> <span class='op'>=</span> <span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_absolute_path'>absolute_path</span><span class='lparen'>(</span><span class='id identifier rubyid_xml'>xml</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_xml_x1'>xml_x1</span> <span class='op'>=</span> <span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_absolute_path'>absolute_path</span><span class='lparen'>(</span><span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_join'>join</span><span class='lparen'>(</span><span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_dirname'>dirname</span><span class='lparen'>(</span><span class='id identifier rubyid_xml'>xml</span><span class='rparen'>)</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>..</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_basename'>basename</span><span class='lparen'>(</span><span class='id identifier rubyid_xml'>xml</span><span class='period'>.</span><span class='id identifier rubyid_gsub'>gsub</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>-x3</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span><span class='rparen'>)</span><span class='rparen'>)</span><span class='rparen'>)</span>

    <span class='id identifier rubyid_results_x3'>results_x3</span> <span class='op'>=</span> <span class='id identifier rubyid_all_results'>all_results</span><span class='lbracket'>[</span><span class='id identifier rubyid_xml_x3'>xml_x3</span><span class='rbracket'>]</span>
    <span class='id identifier rubyid_results_x1'>results_x1</span> <span class='op'>=</span> <span class='id identifier rubyid_all_results'>all_results</span><span class='lbracket'>[</span><span class='id identifier rubyid_xml_x1'>xml_x1</span><span class='rbracket'>]</span>
    <span class='kw'>next</span> <span class='kw'>if</span> <span class='id identifier rubyid_results_x1'>results_x1</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span>

    <span class='comment'># Compare results
</span>    <span class='id identifier rubyid_puts'>puts</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>\nResults for </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_xml'>xml</span><span class='embexpr_end'>}</span><span class='tstring_content'>:</span><span class='tstring_end'>&quot;</span></span>
    <span class='id identifier rubyid_results_x3'>results_x3</span><span class='period'>.</span><span class='id identifier rubyid_keys'>keys</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_k'>k</span><span class='op'>|</span>
      <span class='kw'>next</span> <span class='kw'>if</span> <span class='lbracket'>[</span><span class='ivar'>@simulation_runtime_key</span><span class='comma'>,</span> <span class='ivar'>@workflow_runtime_key</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_include?'>include?</span> <span class='id identifier rubyid_k'>k</span>

      <span class='id identifier rubyid_result_x1'>result_x1</span> <span class='op'>=</span> <span class='id identifier rubyid_results_x1'>results_x1</span><span class='lbracket'>[</span><span class='id identifier rubyid_k'>k</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_to_f'>to_f</span>
      <span class='id identifier rubyid_result_x3'>result_x3</span> <span class='op'>=</span> <span class='id identifier rubyid_results_x3'>results_x3</span><span class='lbracket'>[</span><span class='id identifier rubyid_k'>k</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_to_f'>to_f</span>
      <span class='kw'>next</span> <span class='kw'>if</span> <span class='id identifier rubyid_result_x1'>result_x1</span> <span class='op'>==</span> <span class='float'>0.0</span> <span class='kw'>and</span> <span class='id identifier rubyid_result_x3'>result_x3</span> <span class='op'>==</span> <span class='float'>0.0</span>

      <span class='id identifier rubyid_puts'>puts</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>x1, x3: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_result_x1'>result_x1</span><span class='period'>.</span><span class='id identifier rubyid_round'>round</span><span class='lparen'>(</span><span class='int'>2</span><span class='rparen'>)</span><span class='embexpr_end'>}</span><span class='tstring_content'>, </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_result_x3'>result_x3</span><span class='period'>.</span><span class='id identifier rubyid_round'>round</span><span class='lparen'>(</span><span class='int'>2</span><span class='rparen'>)</span><span class='embexpr_end'>}</span><span class='tstring_content'> </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_k'>k</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>

      <span class='comment'># FIXME: Remove this code after the next E+ release
</span>      <span class='comment'># Skip ZoneHVAC tests on the CI that only pass if using an E+ bugfix version
</span>      <span class='comment'># See https://github.com/NREL/EnergyPlus/pull/7025
</span>      <span class='kw'>if</span> <span class='const'>ENV</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>CI</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span>
        <span class='id identifier rubyid_skip_files_on_ci'>skip_files_on_ci</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>valid-hvac-boiler-elec-only-x3.xml</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>
                            <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>valid-hvac-boiler-gas-only-x3.xml</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>
                            <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>valid-hvac-elec-resistance-only-x3.xml</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>
                            <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>valid-hvac-room-ac-only-x3.xml</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span>
        <span class='kw'>next</span> <span class='kw'>if</span> <span class='id identifier rubyid_skip_files_on_ci'>skip_files_on_ci</span><span class='period'>.</span><span class='id identifier rubyid_include?'>include?</span> <span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_basename'>basename</span><span class='lparen'>(</span><span class='id identifier rubyid_xml_x3'>xml_x3</span><span class='rparen'>)</span>
      <span class='kw'>end</span>

      <span class='id identifier rubyid_assert_in_delta'>assert_in_delta</span><span class='lparen'>(</span><span class='id identifier rubyid_result_x1'>result_x1</span><span class='comma'>,</span> <span class='id identifier rubyid_result_x3'>result_x3</span><span class='comma'>,</span> <span class='float'>0.7</span><span class='rparen'>)</span> <span class='comment'># TODO: Reduce tolerance
</span>    <span class='kw'>end</span>
    <span class='id identifier rubyid_puts'>puts</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>\n</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="_test_partial_hvac-instance_method">
  
    #<strong>_test_partial_hvac</strong>(xmls, hvac_partial_dir, all_results)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


844
845
846
847
848
849
850
851
852
853
854
855
856
857
858
859
860
861
862
863
864
865
866
867
868
869
870
871
872
873
874
875
876
877
878
879
880
881
882
883
884
885</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'tests/hpxml_translator_test.rb', line 844</span>

<span class='kw'>def</span> <span class='id identifier rubyid__test_partial_hvac'>_test_partial_hvac</span><span class='lparen'>(</span><span class='id identifier rubyid_xmls'>xmls</span><span class='comma'>,</span> <span class='id identifier rubyid_hvac_partial_dir'>hvac_partial_dir</span><span class='comma'>,</span> <span class='id identifier rubyid_all_results'>all_results</span><span class='rparen'>)</span>
  <span class='comment'># Compare end use results for a partial HVAC system to a full HVAC system.
</span>  <span class='id identifier rubyid_xmls'>xmls</span><span class='period'>.</span><span class='id identifier rubyid_sort'>sort</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_xml'>xml</span><span class='op'>|</span>
    <span class='kw'>next</span> <span class='kw'>if</span> <span class='kw'>not</span> <span class='id identifier rubyid_xml'>xml</span><span class='period'>.</span><span class='id identifier rubyid_include?'>include?</span> <span class='id identifier rubyid_hvac_partial_dir'>hvac_partial_dir</span>

    <span class='id identifier rubyid_xml_50'>xml_50</span> <span class='op'>=</span> <span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_absolute_path'>absolute_path</span><span class='lparen'>(</span><span class='id identifier rubyid_xml'>xml</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_xml_100'>xml_100</span> <span class='op'>=</span> <span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_absolute_path'>absolute_path</span><span class='lparen'>(</span><span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_join'>join</span><span class='lparen'>(</span><span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_dirname'>dirname</span><span class='lparen'>(</span><span class='id identifier rubyid_xml'>xml</span><span class='rparen'>)</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>..</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_basename'>basename</span><span class='lparen'>(</span><span class='id identifier rubyid_xml'>xml</span><span class='period'>.</span><span class='id identifier rubyid_gsub'>gsub</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>-50percent</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span><span class='rparen'>)</span><span class='rparen'>)</span><span class='rparen'>)</span>

    <span class='id identifier rubyid_results_50'>results_50</span> <span class='op'>=</span> <span class='id identifier rubyid_all_results'>all_results</span><span class='lbracket'>[</span><span class='id identifier rubyid_xml_50'>xml_50</span><span class='rbracket'>]</span>
    <span class='id identifier rubyid_results_100'>results_100</span> <span class='op'>=</span> <span class='id identifier rubyid_all_results'>all_results</span><span class='lbracket'>[</span><span class='id identifier rubyid_xml_100'>xml_100</span><span class='rbracket'>]</span>
    <span class='kw'>next</span> <span class='kw'>if</span> <span class='id identifier rubyid_results_100'>results_100</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span>

    <span class='comment'># Compare results
</span>    <span class='id identifier rubyid_puts'>puts</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>\nResults for </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_xml'>xml</span><span class='embexpr_end'>}</span><span class='tstring_content'>:</span><span class='tstring_end'>&quot;</span></span>
    <span class='id identifier rubyid_results_50'>results_50</span><span class='period'>.</span><span class='id identifier rubyid_keys'>keys</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_k'>k</span><span class='op'>|</span>
      <span class='kw'>next</span> <span class='kw'>if</span> <span class='kw'>not</span> <span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Heating</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Cooling</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_include?'>include?</span> <span class='id identifier rubyid_k'>k</span><span class='lbracket'>[</span><span class='int'>1</span><span class='rbracket'>]</span>
      <span class='kw'>next</span> <span class='kw'>if</span> <span class='kw'>not</span> <span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>General</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_include?'>include?</span> <span class='id identifier rubyid_k'>k</span><span class='lbracket'>[</span><span class='int'>2</span><span class='rbracket'>]</span> <span class='comment'># Exclude crankcase/defrost
</span>
      <span class='id identifier rubyid_result_50'>result_50</span> <span class='op'>=</span> <span class='id identifier rubyid_results_50'>results_50</span><span class='lbracket'>[</span><span class='id identifier rubyid_k'>k</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_to_f'>to_f</span>
      <span class='id identifier rubyid_result_100'>result_100</span> <span class='op'>=</span> <span class='id identifier rubyid_results_100'>results_100</span><span class='lbracket'>[</span><span class='id identifier rubyid_k'>k</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_to_f'>to_f</span>
      <span class='kw'>next</span> <span class='kw'>if</span> <span class='id identifier rubyid_result_50'>result_50</span> <span class='op'>==</span> <span class='float'>0.0</span> <span class='kw'>and</span> <span class='id identifier rubyid_result_100'>result_100</span> <span class='op'>==</span> <span class='float'>0.0</span>

      <span class='id identifier rubyid_puts'>puts</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>50%, 100%: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_result_50'>result_50</span><span class='period'>.</span><span class='id identifier rubyid_round'>round</span><span class='lparen'>(</span><span class='int'>2</span><span class='rparen'>)</span><span class='embexpr_end'>}</span><span class='tstring_content'>, </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_result_100'>result_100</span><span class='period'>.</span><span class='id identifier rubyid_round'>round</span><span class='lparen'>(</span><span class='int'>2</span><span class='rparen'>)</span><span class='embexpr_end'>}</span><span class='tstring_content'> </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_k'>k</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>

      <span class='comment'># FIXME: Remove this code after the next E+ release
</span>      <span class='comment'># Skip ZoneHVAC tests on the CI that only pass if using an E+ bugfix version
</span>      <span class='comment'># See https://github.com/NREL/EnergyPlus/pull/7025
</span>      <span class='kw'>if</span> <span class='const'>ENV</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>CI</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span>
        <span class='id identifier rubyid_skip_files_on_ci'>skip_files_on_ci</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>valid-hvac-boiler-elec-only-50percent.xml</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>
                            <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>valid-hvac-boiler-gas-only-50percent.xml</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>
                            <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>valid-hvac-elec-resistance-only-50percent.xml</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>
                            <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>valid-hvac-room-ac-only-50percent.xml</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>
                            <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>valid-hvac-stove-oil-only-50percent.xml</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>
                            <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>valid-hvac-wall-furnace-propane-only-50percent.xml</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span>
        <span class='kw'>next</span> <span class='kw'>if</span> <span class='id identifier rubyid_skip_files_on_ci'>skip_files_on_ci</span><span class='period'>.</span><span class='id identifier rubyid_include?'>include?</span> <span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_basename'>basename</span><span class='lparen'>(</span><span class='id identifier rubyid_xml_50'>xml_50</span><span class='rparen'>)</span>
      <span class='kw'>end</span>

      <span class='id identifier rubyid_assert_in_delta'>assert_in_delta</span><span class='lparen'>(</span><span class='id identifier rubyid_result_50'>result_50</span><span class='comma'>,</span> <span class='id identifier rubyid_result_100'>result_100</span> <span class='op'>/</span> <span class='float'>2.0</span><span class='comma'>,</span> <span class='float'>0.1</span><span class='rparen'>)</span>
    <span class='kw'>end</span>
    <span class='id identifier rubyid_puts'>puts</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>\n</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="_test_schema_validation-instance_method">
  
    #<strong>_test_schema_validation</strong>(this_dir, xml)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


758
759
760
761
762
763
764
765
766
767</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'tests/hpxml_translator_test.rb', line 758</span>

<span class='kw'>def</span> <span class='id identifier rubyid__test_schema_validation'>_test_schema_validation</span><span class='lparen'>(</span><span class='id identifier rubyid_this_dir'>this_dir</span><span class='comma'>,</span> <span class='id identifier rubyid_xml'>xml</span><span class='rparen'>)</span>
  <span class='comment'># TODO: Remove this when schema validation is included with CLI calls
</span>  <span class='id identifier rubyid_schemas_dir'>schemas_dir</span> <span class='op'>=</span> <span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_absolute_path'>absolute_path</span><span class='lparen'>(</span><span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_join'>join</span><span class='lparen'>(</span><span class='id identifier rubyid_this_dir'>this_dir</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>..</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>hpxml_schemas</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_hpxml_doc'>hpxml_doc</span> <span class='op'>=</span> <span class='const'>REXML</span><span class='op'>::</span><span class='const'>Document</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_read'>read</span><span class='lparen'>(</span><span class='id identifier rubyid_xml'>xml</span><span class='rparen'>)</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_errors'>errors</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="XMLHelper.html" title="XMLHelper (class)">XMLHelper</a></span></span><span class='period'>.</span><span class='id identifier rubyid_validate'><span class='object_link'><a href="XMLHelper.html#validate-class_method" title="XMLHelper.validate (method)">validate</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_hpxml_doc'>hpxml_doc</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span><span class='comma'>,</span> <span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_join'>join</span><span class='lparen'>(</span><span class='id identifier rubyid_schemas_dir'>schemas_dir</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>HPXML.xsd</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span><span class='comma'>,</span> <span class='kw'>nil</span><span class='rparen'>)</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_errors'>errors</span><span class='period'>.</span><span class='id identifier rubyid_size'>size</span> <span class='op'>&gt;</span> <span class='int'>0</span>
    <span class='id identifier rubyid_puts'>puts</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_xml'>xml</span><span class='embexpr_end'>}</span><span class='tstring_content'>: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_errors'>errors</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>end</span>
  <span class='id identifier rubyid_assert_equal'>assert_equal</span><span class='lparen'>(</span><span class='int'>0</span><span class='comma'>,</span> <span class='id identifier rubyid_errors'>errors</span><span class='period'>.</span><span class='id identifier rubyid_size'>size</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="_test_simulation-instance_method">
  
    #<strong>_test_simulation</strong>(args, this_dir, rundir)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
203
204
205
206
207
208
209
210
211
212
213
214
215
216
217
218
219
220
221
222
223
224
225
226
227
228
229
230
231
232
233
234</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'tests/hpxml_translator_test.rb', line 167</span>

<span class='kw'>def</span> <span class='id identifier rubyid__test_simulation'>_test_simulation</span><span class='lparen'>(</span><span class='id identifier rubyid_args'>args</span><span class='comma'>,</span> <span class='id identifier rubyid_this_dir'>this_dir</span><span class='comma'>,</span> <span class='id identifier rubyid_rundir'>rundir</span><span class='rparen'>)</span>
  <span class='comment'># Uses meta_measure workflow for faster simulations
</span>
  <span class='comment'># Setup
</span>  <span class='id identifier rubyid__rm_path'>_rm_path</span><span class='lparen'>(</span><span class='id identifier rubyid_rundir'>rundir</span><span class='rparen'>)</span>
  <span class='const'>Dir</span><span class='period'>.</span><span class='id identifier rubyid_mkdir'>mkdir</span><span class='lparen'>(</span><span class='id identifier rubyid_rundir'>rundir</span><span class='rparen'>)</span>

  <span class='id identifier rubyid_workflow_start'>workflow_start</span> <span class='op'>=</span> <span class='const'>Time</span><span class='period'>.</span><span class='id identifier rubyid_now'>now</span>
  <span class='id identifier rubyid_model'>model</span> <span class='op'>=</span> <span class='const'>OpenStudio</span><span class='op'>::</span><span class='const'>Model</span><span class='op'>::</span><span class='const'>Model</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span>
  <span class='id identifier rubyid_runner'>runner</span> <span class='op'>=</span> <span class='const'>OpenStudio</span><span class='op'>::</span><span class='const'>Measure</span><span class='op'>::</span><span class='const'>OSRunner</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='const'>OpenStudio</span><span class='op'>::</span><span class='const'>WorkflowJSON</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='rparen'>)</span>

  <span class='comment'># Add measure to workflow
</span>  <span class='id identifier rubyid_measures'>measures</span> <span class='op'>=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span>
  <span class='id identifier rubyid_measure_subdir'>measure_subdir</span> <span class='op'>=</span> <span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_absolute_path'>absolute_path</span><span class='lparen'>(</span><span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_join'>join</span><span class='lparen'>(</span><span class='id identifier rubyid_this_dir'>this_dir</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>..</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_split'>split</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>/</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span><span class='lbracket'>[</span><span class='op'>-</span><span class='int'>1</span><span class='rbracket'>]</span>
  <span class='id identifier rubyid_update_args_hash'><span class='object_link'><a href="top-level-namespace.html#update_args_hash-instance_method" title="#update_args_hash (method)">update_args_hash</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_measures'>measures</span><span class='comma'>,</span> <span class='id identifier rubyid_measure_subdir'>measure_subdir</span><span class='comma'>,</span> <span class='id identifier rubyid_args'>args</span><span class='rparen'>)</span>

  <span class='comment'># Apply measure
</span>  <span class='id identifier rubyid_measures_dir'>measures_dir</span> <span class='op'>=</span> <span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_join'>join</span><span class='lparen'>(</span><span class='id identifier rubyid_this_dir'>this_dir</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>../../</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
  <span class='id identifier rubyid_success'>success</span> <span class='op'>=</span> <span class='id identifier rubyid_apply_measures'><span class='object_link'><a href="top-level-namespace.html#apply_measures-instance_method" title="#apply_measures (method)">apply_measures</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_measures_dir'>measures_dir</span><span class='comma'>,</span> <span class='id identifier rubyid_measures'>measures</span><span class='comma'>,</span> <span class='id identifier rubyid_runner'>runner</span><span class='comma'>,</span> <span class='id identifier rubyid_model'>model</span><span class='comma'>,</span> <span class='kw'>nil</span><span class='comma'>,</span> <span class='kw'>nil</span><span class='comma'>,</span> <span class='kw'>true</span><span class='rparen'>)</span>

  <span class='comment'># Report warnings/errors
</span>  <span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_open'>open</span><span class='lparen'>(</span><span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_join'>join</span><span class='lparen'>(</span><span class='id identifier rubyid_rundir'>rundir</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>run.log</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>w</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_f'>f</span><span class='op'>|</span>
    <span class='id identifier rubyid_runner'>runner</span><span class='period'>.</span><span class='id identifier rubyid_result'>result</span><span class='period'>.</span><span class='id identifier rubyid_stepWarnings'>stepWarnings</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_s'>s</span><span class='op'>|</span>
      <span class='id identifier rubyid_f'>f</span> <span class='op'>&lt;&lt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Warning: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_s'>s</span><span class='embexpr_end'>}</span><span class='tstring_content'>\n</span><span class='tstring_end'>&quot;</span></span>
    <span class='kw'>end</span>
    <span class='id identifier rubyid_runner'>runner</span><span class='period'>.</span><span class='id identifier rubyid_result'>result</span><span class='period'>.</span><span class='id identifier rubyid_stepErrors'>stepErrors</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_s'>s</span><span class='op'>|</span>
      <span class='id identifier rubyid_f'>f</span> <span class='op'>&lt;&lt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Error: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_s'>s</span><span class='embexpr_end'>}</span><span class='tstring_content'>\n</span><span class='tstring_end'>&quot;</span></span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_assert'>assert</span><span class='lparen'>(</span><span class='id identifier rubyid_success'>success</span><span class='rparen'>)</span>

  <span class='comment'># Add output variables for crankcase and defrost energy (for DSE tests)
</span>  <span class='id identifier rubyid_vars'>vars</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Cooling Coil Crankcase Heater Electric Energy</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>
          <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Heating Coil Crankcase Heater Electric Energy</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>
          <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Heating Coil Defrost Electric Energy</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span>
  <span class='id identifier rubyid_vars'>vars</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_var'>var</span><span class='op'>|</span>
    <span class='id identifier rubyid_output_var'>output_var</span> <span class='op'>=</span> <span class='const'>OpenStudio</span><span class='op'>::</span><span class='const'>Model</span><span class='op'>::</span><span class='const'>OutputVariable</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='id identifier rubyid_var'>var</span><span class='comma'>,</span> <span class='id identifier rubyid_model'>model</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_output_var'>output_var</span><span class='period'>.</span><span class='id identifier rubyid_setReportingFrequency'>setReportingFrequency</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>runperiod</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
    <span class='id identifier rubyid_output_var'>output_var</span><span class='period'>.</span><span class='id identifier rubyid_setKeyValue'>setKeyValue</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>*</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
  <span class='kw'>end</span>

  <span class='comment'># Add output variable for CFIS fan power
</span>  <span class='id identifier rubyid_output_var'>output_var</span> <span class='op'>=</span> <span class='const'>OpenStudio</span><span class='op'>::</span><span class='const'>Model</span><span class='op'>::</span><span class='const'>OutputVariable</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>res_mv_1_cfis_fan_power</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_model'>model</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_output_var'>output_var</span><span class='period'>.</span><span class='id identifier rubyid_setReportingFrequency'>setReportingFrequency</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>runperiod</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
  <span class='id identifier rubyid_output_var'>output_var</span><span class='period'>.</span><span class='id identifier rubyid_setKeyValue'>setKeyValue</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>EMS</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>

  <span class='comment'># Write model to IDF
</span>  <span class='id identifier rubyid_forward_translator'>forward_translator</span> <span class='op'>=</span> <span class='const'>OpenStudio</span><span class='op'>::</span><span class='const'>EnergyPlus</span><span class='op'>::</span><span class='const'>ForwardTranslator</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span>
  <span class='id identifier rubyid_model_idf'>model_idf</span> <span class='op'>=</span> <span class='id identifier rubyid_forward_translator'>forward_translator</span><span class='period'>.</span><span class='id identifier rubyid_translateModel'>translateModel</span><span class='lparen'>(</span><span class='id identifier rubyid_model'>model</span><span class='rparen'>)</span>
  <span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_open'>open</span><span class='lparen'>(</span><span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_join'>join</span><span class='lparen'>(</span><span class='id identifier rubyid_rundir'>rundir</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>in.idf</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>w</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_f'>f</span><span class='op'>|</span> <span class='id identifier rubyid_f'>f</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_model_idf'>model_idf</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span> <span class='rbrace'>}</span>

  <span class='comment'># Run EnergyPlus
</span>  <span class='id identifier rubyid_ep_path'>ep_path</span> <span class='op'>=</span> <span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_absolute_path'>absolute_path</span><span class='lparen'>(</span><span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_join'>join</span><span class='lparen'>(</span><span class='const'>OpenStudio</span><span class='period'>.</span><span class='id identifier rubyid_getOpenStudioCLI'>getOpenStudioCLI</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>..</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>..</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>EnergyPlus</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>energyplus</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_command'>command</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>cd </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_rundir'>rundir</span><span class='embexpr_end'>}</span><span class='tstring_content'> &amp;&amp; </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_ep_path'>ep_path</span><span class='embexpr_end'>}</span><span class='tstring_content'> -w in.epw in.idf &gt; stdout-energyplus</span><span class='tstring_end'>&quot;</span></span>
  <span class='id identifier rubyid_simulation_start'>simulation_start</span> <span class='op'>=</span> <span class='const'>Time</span><span class='period'>.</span><span class='id identifier rubyid_now'>now</span>
  <span class='id identifier rubyid_system'>system</span><span class='lparen'>(</span><span class='id identifier rubyid_command'>command</span><span class='comma'>,</span> <span class='symbol'>:err</span> <span class='op'>=&gt;</span> <span class='const'>File</span><span class='op'>::</span><span class='const'>NULL</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_sim_time'>sim_time</span> <span class='op'>=</span> <span class='lparen'>(</span><span class='const'>Time</span><span class='period'>.</span><span class='id identifier rubyid_now'>now</span> <span class='op'>-</span> <span class='id identifier rubyid_simulation_start'>simulation_start</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_round'>round</span><span class='lparen'>(</span><span class='int'>1</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_workflow_time'>workflow_time</span> <span class='op'>=</span> <span class='lparen'>(</span><span class='const'>Time</span><span class='period'>.</span><span class='id identifier rubyid_now'>now</span> <span class='op'>-</span> <span class='id identifier rubyid_workflow_start'>workflow_start</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_round'>round</span><span class='lparen'>(</span><span class='int'>1</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_puts'>puts</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Completed </span><span class='embexpr_beg'>#{</span><span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_basename'>basename</span><span class='lparen'>(</span><span class='id identifier rubyid_args'>args</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>hpxml_path</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span><span class='rparen'>)</span><span class='embexpr_end'>}</span><span class='tstring_content'> simulation in </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_sim_time'>sim_time</span><span class='embexpr_end'>}</span><span class='tstring_content'>, workflow in </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_workflow_time'>workflow_time</span><span class='embexpr_end'>}</span><span class='tstring_content'>s.</span><span class='tstring_end'>&quot;</span></span>

  <span class='id identifier rubyid_results'>results</span> <span class='op'>=</span> <span class='id identifier rubyid__get_results'>_get_results</span><span class='lparen'>(</span><span class='id identifier rubyid_rundir'>rundir</span><span class='comma'>,</span> <span class='id identifier rubyid_sim_time'>sim_time</span><span class='comma'>,</span> <span class='id identifier rubyid_workflow_time'>workflow_time</span><span class='rparen'>)</span>

  <span class='comment'># Verify simulation outputs
</span>  <span class='id identifier rubyid__verify_simulation_outputs'>_verify_simulation_outputs</span><span class='lparen'>(</span><span class='id identifier rubyid_rundir'>rundir</span><span class='comma'>,</span> <span class='id identifier rubyid_args'>args</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>hpxml_path</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='id identifier rubyid_results'>results</span><span class='rparen'>)</span>

  <span class='kw'>return</span> <span class='id identifier rubyid_results'>results</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="_verify_simulation_outputs-instance_method">
  
    #<strong>_verify_simulation_outputs</strong>(rundir, hpxml_path, results)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


236
237
238
239
240
241
242
243
244
245
246
247
248
249
250
251
252
253
254
255
256
257
258
259
260
261
262
263
264
265
266
267
268
269
270
271
272
273
274
275
276
277
278
279
280
281
282
283
284
285
286
287
288
289
290
291
292
293
294
295
296
297
298
299
300
301
302
303
304
305
306
307
308
309
310
311
312
313
314
315
316
317
318
319
320
321
322
323
324
325
326
327
328
329
330
331
332
333
334
335
336
337
338
339
340
341
342
343
344
345
346
347
348
349
350
351
352
353
354
355
356
357
358
359
360
361
362
363
364
365
366
367
368
369
370
371
372
373
374
375
376
377
378
379
380
381
382
383
384
385
386
387
388
389
390
391
392
393
394
395
396
397
398
399
400
401
402
403
404
405
406
407
408
409
410
411
412
413
414
415
416
417
418
419
420
421
422
423
424
425
426
427
428
429
430
431
432
433
434
435
436
437
438
439
440
441
442
443
444
445
446
447
448
449
450
451
452
453
454
455
456
457
458
459
460
461
462
463
464
465
466
467
468
469
470
471
472
473
474
475
476
477
478
479
480
481
482
483
484
485
486
487
488
489
490
491
492
493
494
495
496
497
498
499
500
501
502
503
504
505
506
507
508
509
510
511
512
513
514
515
516
517
518
519
520
521
522
523
524
525
526
527
528
529
530
531
532
533
534
535
536
537
538
539
540
541
542
543
544
545
546
547
548
549
550
551
552
553
554
555
556
557
558
559
560
561
562
563
564
565
566
567
568
569
570
571
572
573
574
575
576
577
578
579
580
581
582
583
584
585
586
587
588
589
590
591
592
593
594
595
596
597
598
599
600
601
602
603
604
605
606
607
608
609
610
611
612
613
614
615
616
617
618
619
620
621
622
623
624
625
626
627
628
629
630
631
632
633
634
635
636
637
638
639
640
641
642
643
644
645
646
647
648
649
650
651
652
653
654
655
656
657
658
659
660
661
662
663
664
665
666
667
668
669
670
671
672
673
674
675
676
677
678
679
680
681
682
683
684
685
686
687
688
689
690
691
692
693
694
695
696
697
698
699
700
701
702
703
704
705
706
707
708</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'tests/hpxml_translator_test.rb', line 236</span>

<span class='kw'>def</span> <span class='id identifier rubyid__verify_simulation_outputs'>_verify_simulation_outputs</span><span class='lparen'>(</span><span class='id identifier rubyid_rundir'>rundir</span><span class='comma'>,</span> <span class='id identifier rubyid_hpxml_path'>hpxml_path</span><span class='comma'>,</span> <span class='id identifier rubyid_results'>results</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_sql_path'>sql_path</span> <span class='op'>=</span> <span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_join'>join</span><span class='lparen'>(</span><span class='id identifier rubyid_rundir'>rundir</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>eplusout.sql</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
  <span class='id identifier rubyid_assert'>assert</span><span class='lparen'>(</span><span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_exists?'>exists?</span> <span class='id identifier rubyid_sql_path'>sql_path</span><span class='rparen'>)</span>

  <span class='id identifier rubyid_sqlFile'>sqlFile</span> <span class='op'>=</span> <span class='const'>OpenStudio</span><span class='op'>::</span><span class='const'>SqlFile</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='id identifier rubyid_sql_path'>sql_path</span><span class='comma'>,</span> <span class='kw'>false</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_hpxml_doc'>hpxml_doc</span> <span class='op'>=</span> <span class='const'>REXML</span><span class='op'>::</span><span class='const'>Document</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_read'>read</span><span class='lparen'>(</span><span class='id identifier rubyid_hpxml_path'>hpxml_path</span><span class='rparen'>)</span><span class='rparen'>)</span>

  <span class='id identifier rubyid_bldg_details'>bldg_details</span> <span class='op'>=</span> <span class='id identifier rubyid_hpxml_doc'>hpxml_doc</span><span class='period'>.</span><span class='id identifier rubyid_elements'>elements</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>/HPXML/Building/BuildingDetails</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span>

  <span class='comment'># Conditioned Floor Area
</span>  <span class='id identifier rubyid_sum_hvac_load_frac'>sum_hvac_load_frac</span> <span class='op'>=</span> <span class='lparen'>(</span><span class='id identifier rubyid_bldg_details'>bldg_details</span><span class='period'>.</span><span class='id identifier rubyid_elements'>elements</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>sum(Systems/HVAC/HVACPlant/CoolingSystem/FractionCoolLoadServed)</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='op'>+</span>
                        <span class='id identifier rubyid_bldg_details'>bldg_details</span><span class='period'>.</span><span class='id identifier rubyid_elements'>elements</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>sum(Systems/HVAC/HVACPlant/HeatingSystem/FractionHeatLoadServed)</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='op'>+</span>
                        <span class='id identifier rubyid_bldg_details'>bldg_details</span><span class='period'>.</span><span class='id identifier rubyid_elements'>elements</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>sum(Systems/HVAC/HVACPlant/HeatPump/FractionCoolLoadServed)</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='op'>+</span>
                        <span class='id identifier rubyid_bldg_details'>bldg_details</span><span class='period'>.</span><span class='id identifier rubyid_elements'>elements</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>sum(Systems/HVAC/HVACPlant/HeatPump/FractionHeatLoadServed)</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span><span class='rparen'>)</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_sum_hvac_load_frac'>sum_hvac_load_frac</span> <span class='op'>&gt;</span> <span class='int'>0</span> <span class='comment'># EnergyPlus will only report conditioned floor area if there is an HVAC system
</span>    <span class='id identifier rubyid_hpxml_value'>hpxml_value</span> <span class='op'>=</span> <span class='const'>Float</span><span class='lparen'>(</span><span class='const'><span class='object_link'><a href="XMLHelper.html" title="XMLHelper (class)">XMLHelper</a></span></span><span class='period'>.</span><span class='id identifier rubyid_get_value'><span class='object_link'><a href="XMLHelper.html#get_value-class_method" title="XMLHelper.get_value (method)">get_value</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_bldg_details'>bldg_details</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>BuildingSummary/BuildingConstruction/ConditionedFloorArea</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_query'>query</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>SELECT Value FROM TabularDataWithStrings WHERE ReportName=&#39;InputVerificationandResultsSummary&#39; AND ReportForString=&#39;Entire Facility&#39; AND TableName=&#39;Zone Summary&#39; AND RowName=&#39;Conditioned Total&#39; AND ColumnName=&#39;Area&#39; AND Units=&#39;m2&#39;</span><span class='tstring_end'>&quot;</span></span>
    <span class='id identifier rubyid_sql_value'>sql_value</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="UnitConversions.html" title="UnitConversions (class)">UnitConversions</a></span></span><span class='period'>.</span><span class='id identifier rubyid_convert'><span class='object_link'><a href="UnitConversions.html#convert-class_method" title="UnitConversions.convert (method)">convert</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_sqlFile'>sqlFile</span><span class='period'>.</span><span class='id identifier rubyid_execAndReturnFirstDouble'>execAndReturnFirstDouble</span><span class='lparen'>(</span><span class='id identifier rubyid_query'>query</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_get'>get</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>m^2</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>ft^2</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
    <span class='id identifier rubyid_assert_in_epsilon'>assert_in_epsilon</span><span class='lparen'>(</span><span class='id identifier rubyid_hpxml_value'>hpxml_value</span><span class='comma'>,</span> <span class='id identifier rubyid_sql_value'>sql_value</span><span class='comma'>,</span> <span class='float'>0.01</span><span class='rparen'>)</span>
  <span class='kw'>end</span>

  <span class='comment'># Enclosure Roofs
</span>  <span class='id identifier rubyid_bldg_details'>bldg_details</span><span class='period'>.</span><span class='id identifier rubyid_elements'>elements</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Enclosure/Attics/Attic/Roofs/Roof</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_roof'>roof</span><span class='op'>|</span>
    <span class='id identifier rubyid_roof_id'>roof_id</span> <span class='op'>=</span> <span class='id identifier rubyid_roof'>roof</span><span class='period'>.</span><span class='id identifier rubyid_elements'>elements</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>SystemIdentifier</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_attributes'>attributes</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>id</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_upcase'>upcase</span>

    <span class='comment'># R-value
</span>    <span class='id identifier rubyid_hpxml_value'>hpxml_value</span> <span class='op'>=</span> <span class='const'>Float</span><span class='lparen'>(</span><span class='const'><span class='object_link'><a href="XMLHelper.html" title="XMLHelper (class)">XMLHelper</a></span></span><span class='period'>.</span><span class='id identifier rubyid_get_value'><span class='object_link'><a href="XMLHelper.html#get_value-class_method" title="XMLHelper.get_value (method)">get_value</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_roof'>roof</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Insulation/AssemblyEffectiveRValue</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_query'>query</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>SELECT Value FROM TabularDataWithStrings WHERE ReportName=&#39;EnvelopeSummary&#39; AND ReportForString=&#39;Entire Facility&#39; AND TableName=&#39;Opaque Exterior&#39; AND RowName=&#39;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_roof_id'>roof_id</span><span class='embexpr_end'>}</span><span class='tstring_content'>&#39; AND ColumnName=&#39;U-Factor with Film&#39; AND Units=&#39;W/m2-K&#39;</span><span class='tstring_end'>&quot;</span></span>
    <span class='id identifier rubyid_sql_value'>sql_value</span> <span class='op'>=</span> <span class='float'>1.0</span> <span class='op'>/</span> <span class='const'><span class='object_link'><a href="UnitConversions.html" title="UnitConversions (class)">UnitConversions</a></span></span><span class='period'>.</span><span class='id identifier rubyid_convert'><span class='object_link'><a href="UnitConversions.html#convert-class_method" title="UnitConversions.convert (method)">convert</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_sqlFile'>sqlFile</span><span class='period'>.</span><span class='id identifier rubyid_execAndReturnFirstDouble'>execAndReturnFirstDouble</span><span class='lparen'>(</span><span class='id identifier rubyid_query'>query</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_get'>get</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>W/(m^2*K)</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Btu/(hr*ft^2*F)</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
    <span class='id identifier rubyid_assert_in_epsilon'>assert_in_epsilon</span><span class='lparen'>(</span><span class='id identifier rubyid_hpxml_value'>hpxml_value</span><span class='comma'>,</span> <span class='id identifier rubyid_sql_value'>sql_value</span><span class='comma'>,</span> <span class='float'>0.07</span><span class='rparen'>)</span> <span class='comment'># TODO: Higher due to outside air film?
</span>
    <span class='comment'># Net area
</span>    <span class='id identifier rubyid_hpxml_value'>hpxml_value</span> <span class='op'>=</span> <span class='const'>Float</span><span class='lparen'>(</span><span class='const'><span class='object_link'><a href="XMLHelper.html" title="XMLHelper (class)">XMLHelper</a></span></span><span class='period'>.</span><span class='id identifier rubyid_get_value'><span class='object_link'><a href="XMLHelper.html#get_value-class_method" title="XMLHelper.get_value (method)">get_value</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_roof'>roof</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Area</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_bldg_details'>bldg_details</span><span class='period'>.</span><span class='id identifier rubyid_elements'>elements</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Enclosure/Skylights/Skylight</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_subsurface'>subsurface</span><span class='op'>|</span>
      <span class='kw'>next</span> <span class='kw'>if</span> <span class='id identifier rubyid_subsurface'>subsurface</span><span class='period'>.</span><span class='id identifier rubyid_elements'>elements</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>AttachedToRoof</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_attributes'>attributes</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>idref</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_upcase'>upcase</span> <span class='op'>!=</span> <span class='id identifier rubyid_roof_id'>roof_id</span>

      <span class='id identifier rubyid_hpxml_value'>hpxml_value</span> <span class='op'>-=</span> <span class='const'>Float</span><span class='lparen'>(</span><span class='const'><span class='object_link'><a href="XMLHelper.html" title="XMLHelper (class)">XMLHelper</a></span></span><span class='period'>.</span><span class='id identifier rubyid_get_value'><span class='object_link'><a href="XMLHelper.html#get_value-class_method" title="XMLHelper.get_value (method)">get_value</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_subsurface'>subsurface</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Area</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span><span class='rparen'>)</span>
    <span class='kw'>end</span>
    <span class='id identifier rubyid_query'>query</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>SELECT Value FROM TabularDataWithStrings WHERE ReportName=&#39;EnvelopeSummary&#39; AND ReportForString=&#39;Entire Facility&#39; AND TableName=&#39;Opaque Exterior&#39; AND RowName=&#39;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_roof_id'>roof_id</span><span class='embexpr_end'>}</span><span class='tstring_content'>&#39; AND ColumnName=&#39;Net Area&#39; AND Units=&#39;m2&#39;</span><span class='tstring_end'>&quot;</span></span>
    <span class='id identifier rubyid_sql_value'>sql_value</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="UnitConversions.html" title="UnitConversions (class)">UnitConversions</a></span></span><span class='period'>.</span><span class='id identifier rubyid_convert'><span class='object_link'><a href="UnitConversions.html#convert-class_method" title="UnitConversions.convert (method)">convert</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_sqlFile'>sqlFile</span><span class='period'>.</span><span class='id identifier rubyid_execAndReturnFirstDouble'>execAndReturnFirstDouble</span><span class='lparen'>(</span><span class='id identifier rubyid_query'>query</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_get'>get</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>m^2</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>ft^2</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
    <span class='id identifier rubyid_assert_in_epsilon'>assert_in_epsilon</span><span class='lparen'>(</span><span class='id identifier rubyid_hpxml_value'>hpxml_value</span><span class='comma'>,</span> <span class='id identifier rubyid_sql_value'>sql_value</span><span class='comma'>,</span> <span class='float'>0.01</span><span class='rparen'>)</span>

    <span class='comment'># Solar absorptance
</span>    <span class='id identifier rubyid_hpxml_value'>hpxml_value</span> <span class='op'>=</span> <span class='const'>Float</span><span class='lparen'>(</span><span class='const'><span class='object_link'><a href="XMLHelper.html" title="XMLHelper (class)">XMLHelper</a></span></span><span class='period'>.</span><span class='id identifier rubyid_get_value'><span class='object_link'><a href="XMLHelper.html#get_value-class_method" title="XMLHelper.get_value (method)">get_value</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_roof'>roof</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>SolarAbsorptance</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_query'>query</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>SELECT Value FROM TabularDataWithStrings WHERE ReportName=&#39;EnvelopeSummary&#39; AND ReportForString=&#39;Entire Facility&#39; AND TableName=&#39;Opaque Exterior&#39; AND RowName=&#39;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_roof_id'>roof_id</span><span class='embexpr_end'>}</span><span class='tstring_content'>&#39; AND ColumnName=&#39;Reflectance&#39;</span><span class='tstring_end'>&quot;</span></span>
    <span class='id identifier rubyid_sql_value'>sql_value</span> <span class='op'>=</span> <span class='float'>1.0</span> <span class='op'>-</span> <span class='id identifier rubyid_sqlFile'>sqlFile</span><span class='period'>.</span><span class='id identifier rubyid_execAndReturnFirstDouble'>execAndReturnFirstDouble</span><span class='lparen'>(</span><span class='id identifier rubyid_query'>query</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_get'>get</span>
    <span class='id identifier rubyid_assert_in_epsilon'>assert_in_epsilon</span><span class='lparen'>(</span><span class='id identifier rubyid_hpxml_value'>hpxml_value</span><span class='comma'>,</span> <span class='id identifier rubyid_sql_value'>sql_value</span><span class='comma'>,</span> <span class='float'>0.01</span><span class='rparen'>)</span>

    <span class='comment'># Tilt
</span>    <span class='id identifier rubyid_hpxml_value'>hpxml_value</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="UnitConversions.html" title="UnitConversions (class)">UnitConversions</a></span></span><span class='period'>.</span><span class='id identifier rubyid_convert'><span class='object_link'><a href="UnitConversions.html#convert-class_method" title="UnitConversions.convert (method)">convert</a></span></span><span class='lparen'>(</span><span class='const'>Math</span><span class='period'>.</span><span class='id identifier rubyid_atan'>atan</span><span class='lparen'>(</span><span class='const'>Float</span><span class='lparen'>(</span><span class='const'><span class='object_link'><a href="XMLHelper.html" title="XMLHelper (class)">XMLHelper</a></span></span><span class='period'>.</span><span class='id identifier rubyid_get_value'><span class='object_link'><a href="XMLHelper.html#get_value-class_method" title="XMLHelper.get_value (method)">get_value</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_roof'>roof</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Pitch</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span><span class='rparen'>)</span> <span class='op'>/</span> <span class='float'>12.0</span><span class='rparen'>)</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>rad</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>deg</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
    <span class='id identifier rubyid_query'>query</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>SELECT Value FROM TabularDataWithStrings WHERE ReportName=&#39;EnvelopeSummary&#39; AND ReportForString=&#39;Entire Facility&#39; AND TableName=&#39;Opaque Exterior&#39; AND RowName=&#39;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_roof_id'>roof_id</span><span class='embexpr_end'>}</span><span class='tstring_content'>&#39; AND ColumnName=&#39;Tilt&#39; AND Units=&#39;deg&#39;</span><span class='tstring_end'>&quot;</span></span>
    <span class='id identifier rubyid_sql_value'>sql_value</span> <span class='op'>=</span> <span class='id identifier rubyid_sqlFile'>sqlFile</span><span class='period'>.</span><span class='id identifier rubyid_execAndReturnFirstDouble'>execAndReturnFirstDouble</span><span class='lparen'>(</span><span class='id identifier rubyid_query'>query</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_get'>get</span>
    <span class='id identifier rubyid_assert_in_epsilon'>assert_in_epsilon</span><span class='lparen'>(</span><span class='id identifier rubyid_hpxml_value'>hpxml_value</span><span class='comma'>,</span> <span class='id identifier rubyid_sql_value'>sql_value</span><span class='comma'>,</span> <span class='float'>0.01</span><span class='rparen'>)</span>

    <span class='comment'># Azimuth
</span>    <span class='kw'>if</span> <span class='const'><span class='object_link'><a href="XMLHelper.html" title="XMLHelper (class)">XMLHelper</a></span></span><span class='period'>.</span><span class='id identifier rubyid_has_element'><span class='object_link'><a href="XMLHelper.html#has_element-class_method" title="XMLHelper.has_element (method)">has_element</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_roof'>roof</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Azimuth</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
      <span class='id identifier rubyid_hpxml_value'>hpxml_value</span> <span class='op'>=</span> <span class='const'>Float</span><span class='lparen'>(</span><span class='const'><span class='object_link'><a href="XMLHelper.html" title="XMLHelper (class)">XMLHelper</a></span></span><span class='period'>.</span><span class='id identifier rubyid_get_value'><span class='object_link'><a href="XMLHelper.html#get_value-class_method" title="XMLHelper.get_value (method)">get_value</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_roof'>roof</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Azimuth</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span><span class='rparen'>)</span>
      <span class='id identifier rubyid_query'>query</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>SELECT Value FROM TabularDataWithStrings WHERE ReportName=&#39;EnvelopeSummary&#39; AND ReportForString=&#39;Entire Facility&#39; AND TableName=&#39;Opaque Exterior&#39; AND RowName=&#39;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_roof_id'>roof_id</span><span class='embexpr_end'>}</span><span class='tstring_content'>&#39; AND ColumnName=&#39;Azimuth&#39; AND Units=&#39;deg&#39;</span><span class='tstring_end'>&quot;</span></span>
      <span class='id identifier rubyid_sql_value'>sql_value</span> <span class='op'>=</span> <span class='id identifier rubyid_sqlFile'>sqlFile</span><span class='period'>.</span><span class='id identifier rubyid_execAndReturnFirstDouble'>execAndReturnFirstDouble</span><span class='lparen'>(</span><span class='id identifier rubyid_query'>query</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_get'>get</span>
      <span class='id identifier rubyid_assert_in_epsilon'>assert_in_epsilon</span><span class='lparen'>(</span><span class='id identifier rubyid_hpxml_value'>hpxml_value</span><span class='comma'>,</span> <span class='id identifier rubyid_sql_value'>sql_value</span><span class='comma'>,</span> <span class='float'>0.01</span><span class='rparen'>)</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>

  <span class='comment'># Enclosure Foundation Slabs
</span>  <span class='id identifier rubyid_bldg_details'>bldg_details</span><span class='period'>.</span><span class='id identifier rubyid_elements'>elements</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Enclosure/Foundations/Foundation/Slab</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_slab'>slab</span><span class='op'>|</span>
    <span class='id identifier rubyid_slab_id'>slab_id</span> <span class='op'>=</span> <span class='id identifier rubyid_slab'>slab</span><span class='period'>.</span><span class='id identifier rubyid_elements'>elements</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>SystemIdentifier</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_attributes'>attributes</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>id</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_upcase'>upcase</span>

    <span class='comment'># Area
</span>    <span class='id identifier rubyid_hpxml_value'>hpxml_value</span> <span class='op'>=</span> <span class='const'>Float</span><span class='lparen'>(</span><span class='const'><span class='object_link'><a href="XMLHelper.html" title="XMLHelper (class)">XMLHelper</a></span></span><span class='period'>.</span><span class='id identifier rubyid_get_value'><span class='object_link'><a href="XMLHelper.html#get_value-class_method" title="XMLHelper.get_value (method)">get_value</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_slab'>slab</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Area</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_query'>query</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>SELECT Value FROM TabularDataWithStrings WHERE ReportName=&#39;EnvelopeSummary&#39; AND ReportForString=&#39;Entire Facility&#39; AND TableName=&#39;Opaque Exterior&#39; AND RowName=&#39;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_slab_id'>slab_id</span><span class='embexpr_end'>}</span><span class='tstring_content'>&#39; AND ColumnName=&#39;Gross Area&#39; AND Units=&#39;m2&#39;</span><span class='tstring_end'>&quot;</span></span>
    <span class='id identifier rubyid_sql_value'>sql_value</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="UnitConversions.html" title="UnitConversions (class)">UnitConversions</a></span></span><span class='period'>.</span><span class='id identifier rubyid_convert'><span class='object_link'><a href="UnitConversions.html#convert-class_method" title="UnitConversions.convert (method)">convert</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_sqlFile'>sqlFile</span><span class='period'>.</span><span class='id identifier rubyid_execAndReturnFirstDouble'>execAndReturnFirstDouble</span><span class='lparen'>(</span><span class='id identifier rubyid_query'>query</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_get'>get</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>m^2</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>ft^2</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
    <span class='id identifier rubyid_assert_in_epsilon'>assert_in_epsilon</span><span class='lparen'>(</span><span class='id identifier rubyid_hpxml_value'>hpxml_value</span><span class='comma'>,</span> <span class='id identifier rubyid_sql_value'>sql_value</span><span class='comma'>,</span> <span class='float'>0.01</span><span class='rparen'>)</span>

    <span class='comment'># Tilt
</span>    <span class='id identifier rubyid_query'>query</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>SELECT Value FROM TabularDataWithStrings WHERE ReportName=&#39;EnvelopeSummary&#39; AND ReportForString=&#39;Entire Facility&#39; AND TableName=&#39;Opaque Exterior&#39; AND RowName=&#39;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_slab_id'>slab_id</span><span class='embexpr_end'>}</span><span class='tstring_content'>&#39; AND ColumnName=&#39;Tilt&#39; AND Units=&#39;deg&#39;</span><span class='tstring_end'>&quot;</span></span>
    <span class='id identifier rubyid_sql_value'>sql_value</span> <span class='op'>=</span> <span class='id identifier rubyid_sqlFile'>sqlFile</span><span class='period'>.</span><span class='id identifier rubyid_execAndReturnFirstDouble'>execAndReturnFirstDouble</span><span class='lparen'>(</span><span class='id identifier rubyid_query'>query</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_get'>get</span>
    <span class='id identifier rubyid_assert_in_epsilon'>assert_in_epsilon</span><span class='lparen'>(</span><span class='float'>180.0</span><span class='comma'>,</span> <span class='id identifier rubyid_sql_value'>sql_value</span><span class='comma'>,</span> <span class='float'>0.01</span><span class='rparen'>)</span>
  <span class='kw'>end</span>

  <span class='comment'># Enclosure Foundations
</span>  <span class='comment'># Ensure the correct number of Kiva instances
</span>  <span class='comment'># TODO: Update for multiple foundations and garages.
</span>  <span class='comment'># TODO: Update for walkout basements, which use multiple Kiva instances.
</span>  <span class='id identifier rubyid_in_kiva_block'>in_kiva_block</span> <span class='op'>=</span> <span class='kw'>false</span>
  <span class='id identifier rubyid_num_kiva_instances'>num_kiva_instances</span> <span class='op'>=</span> <span class='int'>0</span>
  <span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_readlines'>readlines</span><span class='lparen'>(</span><span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_join'>join</span><span class='lparen'>(</span><span class='id identifier rubyid_rundir'>rundir</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>eplusout.eio</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_eio_line'>eio_line</span><span class='op'>|</span>
    <span class='kw'>if</span> <span class='id identifier rubyid_eio_line'>eio_line</span><span class='period'>.</span><span class='id identifier rubyid_start_with?'>start_with?</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>! &lt;Kiva Foundation Name&gt;</span><span class='tstring_end'>&quot;</span></span>
      <span class='id identifier rubyid_in_kiva_block'>in_kiva_block</span> <span class='op'>=</span> <span class='kw'>true</span>
      <span class='kw'>next</span>
    <span class='kw'>elsif</span> <span class='id identifier rubyid_in_kiva_block'>in_kiva_block</span>
      <span class='kw'>if</span> <span class='id identifier rubyid_eio_line'>eio_line</span><span class='period'>.</span><span class='id identifier rubyid_start_with?'>start_with?</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>! </span><span class='tstring_end'>&quot;</span></span>
        <span class='kw'>break</span> <span class='comment'># done reading
</span>      <span class='kw'>end</span>

      <span class='id identifier rubyid_num_kiva_instances'>num_kiva_instances</span> <span class='op'>+=</span> <span class='int'>1</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
  <span class='kw'>if</span> <span class='const'><span class='object_link'><a href="XMLHelper.html" title="XMLHelper (class)">XMLHelper</a></span></span><span class='period'>.</span><span class='id identifier rubyid_has_element'><span class='object_link'><a href="XMLHelper.html#has_element-class_method" title="XMLHelper.has_element (method)">has_element</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_bldg_details'>bldg_details</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Enclosure/Foundations/Foundation/FoundationType/Ambient</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
    <span class='id identifier rubyid_assert_equal'>assert_equal</span><span class='lparen'>(</span><span class='int'>0</span><span class='comma'>,</span> <span class='id identifier rubyid_num_kiva_instances'>num_kiva_instances</span><span class='rparen'>)</span>
  <span class='kw'>else</span>
    <span class='id identifier rubyid_assert_equal'>assert_equal</span><span class='lparen'>(</span><span class='int'>1</span><span class='comma'>,</span> <span class='id identifier rubyid_num_kiva_instances'>num_kiva_instances</span><span class='rparen'>)</span>
  <span class='kw'>end</span>

  <span class='comment'># Enclosure Walls
</span>  <span class='id identifier rubyid_bldg_details'>bldg_details</span><span class='period'>.</span><span class='id identifier rubyid_elements'>elements</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Enclosure/Walls/Wall[extension[ExteriorAdjacentTo=&quot;outside&quot;]] | Enclosure/Attics/Attic/Walls/Wall[extension[ExteriorAdjacentTo=&quot;outside&quot;]]</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_wall'>wall</span><span class='op'>|</span>
    <span class='id identifier rubyid_wall_id'>wall_id</span> <span class='op'>=</span> <span class='id identifier rubyid_wall'>wall</span><span class='period'>.</span><span class='id identifier rubyid_elements'>elements</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>SystemIdentifier</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_attributes'>attributes</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>id</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_upcase'>upcase</span>

    <span class='comment'># R-value
</span>    <span class='id identifier rubyid_hpxml_value'>hpxml_value</span> <span class='op'>=</span> <span class='const'>Float</span><span class='lparen'>(</span><span class='const'><span class='object_link'><a href="XMLHelper.html" title="XMLHelper (class)">XMLHelper</a></span></span><span class='period'>.</span><span class='id identifier rubyid_get_value'><span class='object_link'><a href="XMLHelper.html#get_value-class_method" title="XMLHelper.get_value (method)">get_value</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_wall'>wall</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Insulation/AssemblyEffectiveRValue</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_query'>query</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>SELECT Value FROM TabularDataWithStrings WHERE ReportName=&#39;EnvelopeSummary&#39; AND ReportForString=&#39;Entire Facility&#39; AND TableName=&#39;Opaque Exterior&#39; AND RowName=&#39;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_wall_id'>wall_id</span><span class='embexpr_end'>}</span><span class='tstring_content'>&#39; AND ColumnName=&#39;U-Factor with Film&#39; AND Units=&#39;W/m2-K&#39;</span><span class='tstring_end'>&quot;</span></span>
    <span class='id identifier rubyid_sql_value'>sql_value</span> <span class='op'>=</span> <span class='float'>1.0</span> <span class='op'>/</span> <span class='const'><span class='object_link'><a href="UnitConversions.html" title="UnitConversions (class)">UnitConversions</a></span></span><span class='period'>.</span><span class='id identifier rubyid_convert'><span class='object_link'><a href="UnitConversions.html#convert-class_method" title="UnitConversions.convert (method)">convert</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_sqlFile'>sqlFile</span><span class='period'>.</span><span class='id identifier rubyid_execAndReturnFirstDouble'>execAndReturnFirstDouble</span><span class='lparen'>(</span><span class='id identifier rubyid_query'>query</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_get'>get</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>W/(m^2*K)</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Btu/(hr*ft^2*F)</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
    <span class='id identifier rubyid_assert_in_epsilon'>assert_in_epsilon</span><span class='lparen'>(</span><span class='id identifier rubyid_hpxml_value'>hpxml_value</span><span class='comma'>,</span> <span class='id identifier rubyid_sql_value'>sql_value</span><span class='comma'>,</span> <span class='float'>0.03</span><span class='rparen'>)</span>

    <span class='comment'># Net area
</span>    <span class='id identifier rubyid_hpxml_value'>hpxml_value</span> <span class='op'>=</span> <span class='const'>Float</span><span class='lparen'>(</span><span class='const'><span class='object_link'><a href="XMLHelper.html" title="XMLHelper (class)">XMLHelper</a></span></span><span class='period'>.</span><span class='id identifier rubyid_get_value'><span class='object_link'><a href="XMLHelper.html#get_value-class_method" title="XMLHelper.get_value (method)">get_value</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_wall'>wall</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Area</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_bldg_details'>bldg_details</span><span class='period'>.</span><span class='id identifier rubyid_elements'>elements</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Enclosure/Windows/Window | Enclosure/Doors/Door</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_subsurface'>subsurface</span><span class='op'>|</span>
      <span class='kw'>next</span> <span class='kw'>if</span> <span class='id identifier rubyid_subsurface'>subsurface</span><span class='period'>.</span><span class='id identifier rubyid_elements'>elements</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>AttachedToWall</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_attributes'>attributes</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>idref</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_upcase'>upcase</span> <span class='op'>!=</span> <span class='id identifier rubyid_wall_id'>wall_id</span>

      <span class='id identifier rubyid_hpxml_value'>hpxml_value</span> <span class='op'>-=</span> <span class='const'>Float</span><span class='lparen'>(</span><span class='const'><span class='object_link'><a href="XMLHelper.html" title="XMLHelper (class)">XMLHelper</a></span></span><span class='period'>.</span><span class='id identifier rubyid_get_value'><span class='object_link'><a href="XMLHelper.html#get_value-class_method" title="XMLHelper.get_value (method)">get_value</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_subsurface'>subsurface</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Area</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span><span class='rparen'>)</span>
    <span class='kw'>end</span>
    <span class='id identifier rubyid_query'>query</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>SELECT Value FROM TabularDataWithStrings WHERE ReportName=&#39;EnvelopeSummary&#39; AND ReportForString=&#39;Entire Facility&#39; AND TableName=&#39;Opaque Exterior&#39; AND RowName=&#39;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_wall_id'>wall_id</span><span class='embexpr_end'>}</span><span class='tstring_content'>&#39; AND ColumnName=&#39;Net Area&#39; AND Units=&#39;m2&#39;</span><span class='tstring_end'>&quot;</span></span>
    <span class='id identifier rubyid_sql_value'>sql_value</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="UnitConversions.html" title="UnitConversions (class)">UnitConversions</a></span></span><span class='period'>.</span><span class='id identifier rubyid_convert'><span class='object_link'><a href="UnitConversions.html#convert-class_method" title="UnitConversions.convert (method)">convert</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_sqlFile'>sqlFile</span><span class='period'>.</span><span class='id identifier rubyid_execAndReturnFirstDouble'>execAndReturnFirstDouble</span><span class='lparen'>(</span><span class='id identifier rubyid_query'>query</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_get'>get</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>m^2</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>ft^2</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
    <span class='id identifier rubyid_assert_in_epsilon'>assert_in_epsilon</span><span class='lparen'>(</span><span class='id identifier rubyid_hpxml_value'>hpxml_value</span><span class='comma'>,</span> <span class='id identifier rubyid_sql_value'>sql_value</span><span class='comma'>,</span> <span class='float'>0.01</span><span class='rparen'>)</span>

    <span class='comment'># Solar absorptance
</span>    <span class='id identifier rubyid_hpxml_value'>hpxml_value</span> <span class='op'>=</span> <span class='const'>Float</span><span class='lparen'>(</span><span class='const'><span class='object_link'><a href="XMLHelper.html" title="XMLHelper (class)">XMLHelper</a></span></span><span class='period'>.</span><span class='id identifier rubyid_get_value'><span class='object_link'><a href="XMLHelper.html#get_value-class_method" title="XMLHelper.get_value (method)">get_value</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_wall'>wall</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>SolarAbsorptance</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_query'>query</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>SELECT Value FROM TabularDataWithStrings WHERE ReportName=&#39;EnvelopeSummary&#39; AND ReportForString=&#39;Entire Facility&#39; AND TableName=&#39;Opaque Exterior&#39; AND RowName=&#39;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_wall_id'>wall_id</span><span class='embexpr_end'>}</span><span class='tstring_content'>&#39; AND ColumnName=&#39;Reflectance&#39;</span><span class='tstring_end'>&quot;</span></span>
    <span class='id identifier rubyid_sql_value'>sql_value</span> <span class='op'>=</span> <span class='float'>1.0</span> <span class='op'>-</span> <span class='id identifier rubyid_sqlFile'>sqlFile</span><span class='period'>.</span><span class='id identifier rubyid_execAndReturnFirstDouble'>execAndReturnFirstDouble</span><span class='lparen'>(</span><span class='id identifier rubyid_query'>query</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_get'>get</span>
    <span class='id identifier rubyid_assert_in_epsilon'>assert_in_epsilon</span><span class='lparen'>(</span><span class='id identifier rubyid_hpxml_value'>hpxml_value</span><span class='comma'>,</span> <span class='id identifier rubyid_sql_value'>sql_value</span><span class='comma'>,</span> <span class='float'>0.01</span><span class='rparen'>)</span>

    <span class='comment'># Tilt
</span>    <span class='id identifier rubyid_query'>query</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>SELECT Value FROM TabularDataWithStrings WHERE ReportName=&#39;EnvelopeSummary&#39; AND ReportForString=&#39;Entire Facility&#39; AND TableName=&#39;Opaque Exterior&#39; AND RowName=&#39;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_wall_id'>wall_id</span><span class='embexpr_end'>}</span><span class='tstring_content'>&#39; AND ColumnName=&#39;Tilt&#39; AND Units=&#39;deg&#39;</span><span class='tstring_end'>&quot;</span></span>
    <span class='id identifier rubyid_sql_value'>sql_value</span> <span class='op'>=</span> <span class='id identifier rubyid_sqlFile'>sqlFile</span><span class='period'>.</span><span class='id identifier rubyid_execAndReturnFirstDouble'>execAndReturnFirstDouble</span><span class='lparen'>(</span><span class='id identifier rubyid_query'>query</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_get'>get</span>
    <span class='id identifier rubyid_assert_in_epsilon'>assert_in_epsilon</span><span class='lparen'>(</span><span class='float'>90.0</span><span class='comma'>,</span> <span class='id identifier rubyid_sql_value'>sql_value</span><span class='comma'>,</span> <span class='float'>0.01</span><span class='rparen'>)</span>

    <span class='comment'># Azimuth
</span>    <span class='kw'>if</span> <span class='const'><span class='object_link'><a href="XMLHelper.html" title="XMLHelper (class)">XMLHelper</a></span></span><span class='period'>.</span><span class='id identifier rubyid_has_element'><span class='object_link'><a href="XMLHelper.html#has_element-class_method" title="XMLHelper.has_element (method)">has_element</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_wall'>wall</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Azimuth</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
      <span class='id identifier rubyid_hpxml_value'>hpxml_value</span> <span class='op'>=</span> <span class='const'>Float</span><span class='lparen'>(</span><span class='const'><span class='object_link'><a href="XMLHelper.html" title="XMLHelper (class)">XMLHelper</a></span></span><span class='period'>.</span><span class='id identifier rubyid_get_value'><span class='object_link'><a href="XMLHelper.html#get_value-class_method" title="XMLHelper.get_value (method)">get_value</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_wall'>wall</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Azimuth</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span><span class='rparen'>)</span>
      <span class='id identifier rubyid_query'>query</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>SELECT Value FROM TabularDataWithStrings WHERE ReportName=&#39;EnvelopeSummary&#39; AND ReportForString=&#39;Entire Facility&#39; AND TableName=&#39;Opaque Exterior&#39; AND RowName=&#39;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_wall_id'>wall_id</span><span class='embexpr_end'>}</span><span class='tstring_content'>&#39; AND ColumnName=&#39;Azimuth&#39; AND Units=&#39;deg&#39;</span><span class='tstring_end'>&quot;</span></span>
      <span class='id identifier rubyid_sql_value'>sql_value</span> <span class='op'>=</span> <span class='id identifier rubyid_sqlFile'>sqlFile</span><span class='period'>.</span><span class='id identifier rubyid_execAndReturnFirstDouble'>execAndReturnFirstDouble</span><span class='lparen'>(</span><span class='id identifier rubyid_query'>query</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_get'>get</span>
      <span class='id identifier rubyid_assert_in_epsilon'>assert_in_epsilon</span><span class='lparen'>(</span><span class='id identifier rubyid_hpxml_value'>hpxml_value</span><span class='comma'>,</span> <span class='id identifier rubyid_sql_value'>sql_value</span><span class='comma'>,</span> <span class='float'>0.01</span><span class='rparen'>)</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>

  <span class='comment'># Enclosure Windows/Skylights
</span>  <span class='id identifier rubyid_bldg_details'>bldg_details</span><span class='period'>.</span><span class='id identifier rubyid_elements'>elements</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Enclosure/Windows/Window | Enclosure/Skylights/Skylight</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_subsurface'>subsurface</span><span class='op'>|</span>
    <span class='id identifier rubyid_subsurface_id'>subsurface_id</span> <span class='op'>=</span> <span class='id identifier rubyid_subsurface'>subsurface</span><span class='period'>.</span><span class='id identifier rubyid_elements'>elements</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>SystemIdentifier</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_attributes'>attributes</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>id</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_upcase'>upcase</span>

    <span class='comment'># Area
</span>    <span class='id identifier rubyid_hpxml_value'>hpxml_value</span> <span class='op'>=</span> <span class='const'>Float</span><span class='lparen'>(</span><span class='const'><span class='object_link'><a href="XMLHelper.html" title="XMLHelper (class)">XMLHelper</a></span></span><span class='period'>.</span><span class='id identifier rubyid_get_value'><span class='object_link'><a href="XMLHelper.html#get_value-class_method" title="XMLHelper.get_value (method)">get_value</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_subsurface'>subsurface</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Area</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_query'>query</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>SELECT Value FROM TabularDataWithStrings WHERE ReportName=&#39;EnvelopeSummary&#39; AND ReportForString=&#39;Entire Facility&#39; AND TableName=&#39;Exterior Fenestration&#39; AND RowName=&#39;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_subsurface_id'>subsurface_id</span><span class='embexpr_end'>}</span><span class='tstring_content'>&#39; AND ColumnName=&#39;Area of Multiplied Openings&#39; AND Units=&#39;m2&#39;</span><span class='tstring_end'>&quot;</span></span>
    <span class='id identifier rubyid_sql_value'>sql_value</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="UnitConversions.html" title="UnitConversions (class)">UnitConversions</a></span></span><span class='period'>.</span><span class='id identifier rubyid_convert'><span class='object_link'><a href="UnitConversions.html#convert-class_method" title="UnitConversions.convert (method)">convert</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_sqlFile'>sqlFile</span><span class='period'>.</span><span class='id identifier rubyid_execAndReturnFirstDouble'>execAndReturnFirstDouble</span><span class='lparen'>(</span><span class='id identifier rubyid_query'>query</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_get'>get</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>m^2</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>ft^2</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
    <span class='id identifier rubyid_assert_in_epsilon'>assert_in_epsilon</span><span class='lparen'>(</span><span class='id identifier rubyid_hpxml_value'>hpxml_value</span><span class='comma'>,</span> <span class='id identifier rubyid_sql_value'>sql_value</span><span class='comma'>,</span> <span class='float'>0.01</span><span class='rparen'>)</span>

    <span class='comment'># U-Factor
</span>    <span class='id identifier rubyid_hpxml_value'>hpxml_value</span> <span class='op'>=</span> <span class='const'>Float</span><span class='lparen'>(</span><span class='const'><span class='object_link'><a href="XMLHelper.html" title="XMLHelper (class)">XMLHelper</a></span></span><span class='period'>.</span><span class='id identifier rubyid_get_value'><span class='object_link'><a href="XMLHelper.html#get_value-class_method" title="XMLHelper.get_value (method)">get_value</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_subsurface'>subsurface</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>UFactor</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_query'>query</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>SELECT Value FROM TabularDataWithStrings WHERE ReportName=&#39;EnvelopeSummary&#39; AND ReportForString=&#39;Entire Facility&#39; AND TableName=&#39;Exterior Fenestration&#39; AND RowName=&#39;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_subsurface_id'>subsurface_id</span><span class='embexpr_end'>}</span><span class='tstring_content'>&#39; AND ColumnName=&#39;Glass U-Factor&#39; AND Units=&#39;W/m2-K&#39;</span><span class='tstring_end'>&quot;</span></span>
    <span class='id identifier rubyid_sql_value'>sql_value</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="UnitConversions.html" title="UnitConversions (class)">UnitConversions</a></span></span><span class='period'>.</span><span class='id identifier rubyid_convert'><span class='object_link'><a href="UnitConversions.html#convert-class_method" title="UnitConversions.convert (method)">convert</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_sqlFile'>sqlFile</span><span class='period'>.</span><span class='id identifier rubyid_execAndReturnFirstDouble'>execAndReturnFirstDouble</span><span class='lparen'>(</span><span class='id identifier rubyid_query'>query</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_get'>get</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>W/(m^2*K)</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Btu/(hr*ft^2*F)</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
    <span class='id identifier rubyid_assert_in_epsilon'>assert_in_epsilon</span><span class='lparen'>(</span><span class='id identifier rubyid_hpxml_value'>hpxml_value</span><span class='comma'>,</span> <span class='id identifier rubyid_sql_value'>sql_value</span><span class='comma'>,</span> <span class='float'>0.01</span><span class='rparen'>)</span>

    <span class='comment'># SHGC
</span>    <span class='comment'># TODO: Affected by interior shading
</span>
    <span class='comment'># Azimuth
</span>    <span class='id identifier rubyid_hpxml_value'>hpxml_value</span> <span class='op'>=</span> <span class='const'>Float</span><span class='lparen'>(</span><span class='const'><span class='object_link'><a href="XMLHelper.html" title="XMLHelper (class)">XMLHelper</a></span></span><span class='period'>.</span><span class='id identifier rubyid_get_value'><span class='object_link'><a href="XMLHelper.html#get_value-class_method" title="XMLHelper.get_value (method)">get_value</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_subsurface'>subsurface</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Azimuth</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_query'>query</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>SELECT Value FROM TabularDataWithStrings WHERE ReportName=&#39;EnvelopeSummary&#39; AND ReportForString=&#39;Entire Facility&#39; AND TableName=&#39;Exterior Fenestration&#39; AND RowName=&#39;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_subsurface_id'>subsurface_id</span><span class='embexpr_end'>}</span><span class='tstring_content'>&#39; AND ColumnName=&#39;Azimuth&#39; AND Units=&#39;deg&#39;</span><span class='tstring_end'>&quot;</span></span>
    <span class='id identifier rubyid_sql_value'>sql_value</span> <span class='op'>=</span> <span class='id identifier rubyid_sqlFile'>sqlFile</span><span class='period'>.</span><span class='id identifier rubyid_execAndReturnFirstDouble'>execAndReturnFirstDouble</span><span class='lparen'>(</span><span class='id identifier rubyid_query'>query</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_get'>get</span>
    <span class='id identifier rubyid_assert_in_epsilon'>assert_in_epsilon</span><span class='lparen'>(</span><span class='id identifier rubyid_hpxml_value'>hpxml_value</span><span class='comma'>,</span> <span class='id identifier rubyid_sql_value'>sql_value</span><span class='comma'>,</span> <span class='float'>0.01</span><span class='rparen'>)</span>

    <span class='comment'># Tilt
</span>    <span class='kw'>if</span> <span class='const'><span class='object_link'><a href="XMLHelper.html" title="XMLHelper (class)">XMLHelper</a></span></span><span class='period'>.</span><span class='id identifier rubyid_has_element'><span class='object_link'><a href="XMLHelper.html#has_element-class_method" title="XMLHelper.has_element (method)">has_element</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_subsurface'>subsurface</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>AttachedToWall</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
      <span class='id identifier rubyid_query'>query</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>SELECT Value FROM TabularDataWithStrings WHERE ReportName=&#39;EnvelopeSummary&#39; AND ReportForString=&#39;Entire Facility&#39; AND TableName=&#39;Exterior Fenestration&#39; AND RowName=&#39;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_subsurface_id'>subsurface_id</span><span class='embexpr_end'>}</span><span class='tstring_content'>&#39; AND ColumnName=&#39;Tilt&#39; AND Units=&#39;deg&#39;</span><span class='tstring_end'>&quot;</span></span>
      <span class='id identifier rubyid_sql_value'>sql_value</span> <span class='op'>=</span> <span class='id identifier rubyid_sqlFile'>sqlFile</span><span class='period'>.</span><span class='id identifier rubyid_execAndReturnFirstDouble'>execAndReturnFirstDouble</span><span class='lparen'>(</span><span class='id identifier rubyid_query'>query</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_get'>get</span>
      <span class='id identifier rubyid_assert_in_epsilon'>assert_in_epsilon</span><span class='lparen'>(</span><span class='float'>90.0</span><span class='comma'>,</span> <span class='id identifier rubyid_sql_value'>sql_value</span><span class='comma'>,</span> <span class='float'>0.01</span><span class='rparen'>)</span>
    <span class='kw'>elsif</span> <span class='const'><span class='object_link'><a href="XMLHelper.html" title="XMLHelper (class)">XMLHelper</a></span></span><span class='period'>.</span><span class='id identifier rubyid_has_element'><span class='object_link'><a href="XMLHelper.html#has_element-class_method" title="XMLHelper.has_element (method)">has_element</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_subsurface'>subsurface</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>AttachedToRoof</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
      <span class='id identifier rubyid_hpxml_value'>hpxml_value</span> <span class='op'>=</span> <span class='kw'>nil</span>
      <span class='id identifier rubyid_bldg_details'>bldg_details</span><span class='period'>.</span><span class='id identifier rubyid_elements'>elements</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Enclosure/Attics/Attic/Roofs/Roof</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_roof'>roof</span><span class='op'>|</span>
        <span class='kw'>next</span> <span class='kw'>if</span> <span class='id identifier rubyid_roof'>roof</span><span class='period'>.</span><span class='id identifier rubyid_elements'>elements</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>SystemIdentifier</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_attributes'>attributes</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>id</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span> <span class='op'>!=</span> <span class='id identifier rubyid_subsurface'>subsurface</span><span class='period'>.</span><span class='id identifier rubyid_elements'>elements</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>AttachedToRoof</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_attributes'>attributes</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>idref</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span>

        <span class='id identifier rubyid_hpxml_value'>hpxml_value</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="UnitConversions.html" title="UnitConversions (class)">UnitConversions</a></span></span><span class='period'>.</span><span class='id identifier rubyid_convert'><span class='object_link'><a href="UnitConversions.html#convert-class_method" title="UnitConversions.convert (method)">convert</a></span></span><span class='lparen'>(</span><span class='const'>Math</span><span class='period'>.</span><span class='id identifier rubyid_atan'>atan</span><span class='lparen'>(</span><span class='const'>Float</span><span class='lparen'>(</span><span class='const'><span class='object_link'><a href="XMLHelper.html" title="XMLHelper (class)">XMLHelper</a></span></span><span class='period'>.</span><span class='id identifier rubyid_get_value'><span class='object_link'><a href="XMLHelper.html#get_value-class_method" title="XMLHelper.get_value (method)">get_value</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_roof'>roof</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Pitch</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span><span class='rparen'>)</span> <span class='op'>/</span> <span class='float'>12.0</span><span class='rparen'>)</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>rad</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>deg</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
      <span class='kw'>end</span>
      <span class='id identifier rubyid_query'>query</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>SELECT Value FROM TabularDataWithStrings WHERE ReportName=&#39;EnvelopeSummary&#39; AND ReportForString=&#39;Entire Facility&#39; AND TableName=&#39;Exterior Fenestration&#39; AND RowName=&#39;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_subsurface_id'>subsurface_id</span><span class='embexpr_end'>}</span><span class='tstring_content'>&#39; AND ColumnName=&#39;Tilt&#39; AND Units=&#39;deg&#39;</span><span class='tstring_end'>&quot;</span></span>
      <span class='id identifier rubyid_sql_value'>sql_value</span> <span class='op'>=</span> <span class='id identifier rubyid_sqlFile'>sqlFile</span><span class='period'>.</span><span class='id identifier rubyid_execAndReturnFirstDouble'>execAndReturnFirstDouble</span><span class='lparen'>(</span><span class='id identifier rubyid_query'>query</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_get'>get</span>
      <span class='id identifier rubyid_assert_in_epsilon'>assert_in_epsilon</span><span class='lparen'>(</span><span class='id identifier rubyid_hpxml_value'>hpxml_value</span><span class='comma'>,</span> <span class='id identifier rubyid_sql_value'>sql_value</span><span class='comma'>,</span> <span class='float'>0.01</span><span class='rparen'>)</span>
    <span class='kw'>else</span>
      <span class='id identifier rubyid_flunk'>flunk</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Subsurface &#39;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_subsurface_id'>subsurface_id</span><span class='embexpr_end'>}</span><span class='tstring_content'>&#39; should have either AttachedToWall or AttachedToRoof element.</span><span class='tstring_end'>&quot;</span></span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>

  <span class='comment'># Enclosure Doors
</span>  <span class='id identifier rubyid_bldg_details'>bldg_details</span><span class='period'>.</span><span class='id identifier rubyid_elements'>elements</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Enclosure/Doors/Door</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_door'>door</span><span class='op'>|</span>
    <span class='id identifier rubyid_door_id'>door_id</span> <span class='op'>=</span> <span class='id identifier rubyid_door'>door</span><span class='period'>.</span><span class='id identifier rubyid_elements'>elements</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>SystemIdentifier</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_attributes'>attributes</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>id</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_upcase'>upcase</span>

    <span class='comment'># Area
</span>    <span class='id identifier rubyid_hpxml_value'>hpxml_value</span> <span class='op'>=</span> <span class='const'>Float</span><span class='lparen'>(</span><span class='const'><span class='object_link'><a href="XMLHelper.html" title="XMLHelper (class)">XMLHelper</a></span></span><span class='period'>.</span><span class='id identifier rubyid_get_value'><span class='object_link'><a href="XMLHelper.html#get_value-class_method" title="XMLHelper.get_value (method)">get_value</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_door'>door</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Area</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_query'>query</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>SELECT Value FROM TabularDataWithStrings WHERE ReportName=&#39;EnvelopeSummary&#39; AND ReportForString=&#39;Entire Facility&#39; AND TableName=&#39;Exterior Door&#39; AND RowName=&#39;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_door_id'>door_id</span><span class='embexpr_end'>}</span><span class='tstring_content'>&#39; AND ColumnName=&#39;Gross Area&#39; AND Units=&#39;m2&#39;</span><span class='tstring_end'>&quot;</span></span>
    <span class='id identifier rubyid_sql_value'>sql_value</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="UnitConversions.html" title="UnitConversions (class)">UnitConversions</a></span></span><span class='period'>.</span><span class='id identifier rubyid_convert'><span class='object_link'><a href="UnitConversions.html#convert-class_method" title="UnitConversions.convert (method)">convert</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_sqlFile'>sqlFile</span><span class='period'>.</span><span class='id identifier rubyid_execAndReturnFirstDouble'>execAndReturnFirstDouble</span><span class='lparen'>(</span><span class='id identifier rubyid_query'>query</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_get'>get</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>m^2</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>ft^2</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
    <span class='id identifier rubyid_assert_in_epsilon'>assert_in_epsilon</span><span class='lparen'>(</span><span class='id identifier rubyid_hpxml_value'>hpxml_value</span><span class='comma'>,</span> <span class='id identifier rubyid_sql_value'>sql_value</span><span class='comma'>,</span> <span class='float'>0.01</span><span class='rparen'>)</span>

    <span class='comment'># R-Value
</span>    <span class='id identifier rubyid_hpxml_value'>hpxml_value</span> <span class='op'>=</span> <span class='const'>Float</span><span class='lparen'>(</span><span class='const'><span class='object_link'><a href="XMLHelper.html" title="XMLHelper (class)">XMLHelper</a></span></span><span class='period'>.</span><span class='id identifier rubyid_get_value'><span class='object_link'><a href="XMLHelper.html#get_value-class_method" title="XMLHelper.get_value (method)">get_value</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_door'>door</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>RValue</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_query'>query</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>SELECT Value FROM TabularDataWithStrings WHERE ReportName=&#39;EnvelopeSummary&#39; AND ReportForString=&#39;Entire Facility&#39; AND TableName=&#39;Exterior Door&#39; AND RowName=&#39;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_door_id'>door_id</span><span class='embexpr_end'>}</span><span class='tstring_content'>&#39; AND ColumnName=&#39;U-Factor with Film&#39; AND Units=&#39;W/m2-K&#39;</span><span class='tstring_end'>&quot;</span></span>
    <span class='id identifier rubyid_sql_value'>sql_value</span> <span class='op'>=</span> <span class='float'>1.0</span> <span class='op'>/</span> <span class='const'><span class='object_link'><a href="UnitConversions.html" title="UnitConversions (class)">UnitConversions</a></span></span><span class='period'>.</span><span class='id identifier rubyid_convert'><span class='object_link'><a href="UnitConversions.html#convert-class_method" title="UnitConversions.convert (method)">convert</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_sqlFile'>sqlFile</span><span class='period'>.</span><span class='id identifier rubyid_execAndReturnFirstDouble'>execAndReturnFirstDouble</span><span class='lparen'>(</span><span class='id identifier rubyid_query'>query</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_get'>get</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>W/(m^2*K)</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Btu/(hr*ft^2*F)</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
    <span class='id identifier rubyid_assert_in_epsilon'>assert_in_epsilon</span><span class='lparen'>(</span><span class='id identifier rubyid_hpxml_value'>hpxml_value</span><span class='comma'>,</span> <span class='id identifier rubyid_sql_value'>sql_value</span><span class='comma'>,</span> <span class='float'>0.01</span><span class='rparen'>)</span>
  <span class='kw'>end</span>

  <span class='comment'># HVAC Heating Systems
</span>  <span class='id identifier rubyid_num_htg_sys'>num_htg_sys</span> <span class='op'>=</span> <span class='id identifier rubyid_bldg_details'>bldg_details</span><span class='period'>.</span><span class='id identifier rubyid_elements'>elements</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>count(Systems/HVAC/HVACPlant/HeatingSystem)</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span>
  <span class='id identifier rubyid_bldg_details'>bldg_details</span><span class='period'>.</span><span class='id identifier rubyid_elements'>elements</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Systems/HVAC/HVACPlant/HeatingSystem</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_htg_sys'>htg_sys</span><span class='op'>|</span>
    <span class='id identifier rubyid_htg_sys_id'>htg_sys_id</span> <span class='op'>=</span> <span class='id identifier rubyid_htg_sys'>htg_sys</span><span class='period'>.</span><span class='id identifier rubyid_elements'>elements</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>SystemIdentifier</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_attributes'>attributes</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>id</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_upcase'>upcase</span>
    <span class='id identifier rubyid_htg_sys_type'>htg_sys_type</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="XMLHelper.html" title="XMLHelper (class)">XMLHelper</a></span></span><span class='period'>.</span><span class='id identifier rubyid_get_child_name'><span class='object_link'><a href="XMLHelper.html#get_child_name-class_method" title="XMLHelper.get_child_name (method)">get_child_name</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_htg_sys'>htg_sys</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>HeatingSystemType</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
    <span class='id identifier rubyid_htg_sys_fuel'>htg_sys_fuel</span> <span class='op'>=</span> <span class='id identifier rubyid_to_beopt_fuel'><span class='object_link'><a href="top-level-namespace.html#to_beopt_fuel-instance_method" title="#to_beopt_fuel (method)">to_beopt_fuel</a></span></span><span class='lparen'>(</span><span class='const'><span class='object_link'><a href="XMLHelper.html" title="XMLHelper (class)">XMLHelper</a></span></span><span class='period'>.</span><span class='id identifier rubyid_get_value'><span class='object_link'><a href="XMLHelper.html#get_value-class_method" title="XMLHelper.get_value (method)">get_value</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_htg_sys'>htg_sys</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>HeatingSystemFuel</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_htg_sys_cap'>htg_sys_cap</span> <span class='op'>=</span> <span class='const'>Float</span><span class='lparen'>(</span><span class='const'><span class='object_link'><a href="XMLHelper.html" title="XMLHelper (class)">XMLHelper</a></span></span><span class='period'>.</span><span class='id identifier rubyid_get_value'><span class='object_link'><a href="XMLHelper.html#get_value-class_method" title="XMLHelper.get_value (method)">get_value</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_htg_sys'>htg_sys</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>HeatingCapacity</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_htg_dse'>htg_dse</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="XMLHelper.html" title="XMLHelper (class)">XMLHelper</a></span></span><span class='period'>.</span><span class='id identifier rubyid_get_value'><span class='object_link'><a href="XMLHelper.html#get_value-class_method" title="XMLHelper.get_value (method)">get_value</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_bldg_details'>bldg_details</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Systems/HVAC/HVACDistribution/AnnualHeatingDistributionSystemEfficiency</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
    <span class='kw'>if</span> <span class='id identifier rubyid_htg_dse'>htg_dse</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span>
      <span class='id identifier rubyid_htg_dse'>htg_dse</span> <span class='op'>=</span> <span class='float'>1.0</span>
    <span class='kw'>else</span>
      <span class='id identifier rubyid_htg_dse'>htg_dse</span> <span class='op'>=</span> <span class='const'>Float</span><span class='lparen'>(</span><span class='id identifier rubyid_htg_dse'>htg_dse</span><span class='rparen'>)</span>
    <span class='kw'>end</span>
    <span class='id identifier rubyid_htg_load_frac'>htg_load_frac</span> <span class='op'>=</span> <span class='const'>Float</span><span class='lparen'>(</span><span class='const'><span class='object_link'><a href="XMLHelper.html" title="XMLHelper (class)">XMLHelper</a></span></span><span class='period'>.</span><span class='id identifier rubyid_get_value'><span class='object_link'><a href="XMLHelper.html#get_value-class_method" title="XMLHelper.get_value (method)">get_value</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_htg_sys'>htg_sys</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>FractionHeatLoadServed</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span><span class='rparen'>)</span>

    <span class='kw'>if</span> <span class='id identifier rubyid_htg_load_frac'>htg_load_frac</span> <span class='op'>&lt;=</span> <span class='int'>0</span>

      <span class='comment'># Heating Load Fraction
</span>      <span class='comment'># Check for zero heating energy
</span>      <span class='id identifier rubyid_found_htg_energy'>found_htg_energy</span> <span class='op'>=</span> <span class='kw'>false</span>
      <span class='id identifier rubyid_results'>results</span><span class='period'>.</span><span class='id identifier rubyid_keys'>keys</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_k'>k</span><span class='op'>|</span>
        <span class='kw'>next</span> <span class='kw'>unless</span> <span class='id identifier rubyid_k'>k</span><span class='lbracket'>[</span><span class='int'>1</span><span class='rbracket'>]</span> <span class='op'>==</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Heating</span><span class='tstring_end'>&#39;</span></span>

        <span class='id identifier rubyid_found_htg_energy'>found_htg_energy</span> <span class='op'>=</span> <span class='kw'>true</span>
      <span class='kw'>end</span>
      <span class='id identifier rubyid_assert_equal'>assert_equal</span><span class='lparen'>(</span><span class='kw'>false</span><span class='comma'>,</span> <span class='id identifier rubyid_found_htg_energy'>found_htg_energy</span><span class='rparen'>)</span>

    <span class='kw'>else</span>

      <span class='comment'># Heating Capacity
</span>      <span class='comment'># FIXME: For now, skip if multiple equipment
</span>      <span class='kw'>if</span> <span class='id identifier rubyid_htg_sys_cap'>htg_sys_cap</span> <span class='op'>&gt;</span> <span class='int'>0</span> <span class='kw'>and</span> <span class='id identifier rubyid_num_htg_sys'>num_htg_sys</span> <span class='op'>==</span> <span class='int'>1</span>
        <span class='id identifier rubyid_hpxml_value'>hpxml_value</span> <span class='op'>=</span> <span class='id identifier rubyid_htg_sys_cap'>htg_sys_cap</span>
        <span class='kw'>if</span> <span class='id identifier rubyid_htg_sys_type'>htg_sys_type</span> <span class='op'>==</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Boiler</span><span class='tstring_end'>&#39;</span></span>
          <span class='id identifier rubyid_query'>query</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>SELECT SUM(Value) FROM TabularDataWithStrings WHERE ReportName=&#39;ComponentSizingSummary&#39; AND ReportForString=&#39;Entire Facility&#39; AND TableName=&#39;Boiler:HotWater&#39; AND ColumnName=&#39;User-Specified Nominal Capacity&#39; AND Units=&#39;W&#39;</span><span class='tstring_end'>&quot;</span></span>
        <span class='kw'>elsif</span> <span class='id identifier rubyid_htg_sys_type'>htg_sys_type</span> <span class='op'>==</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>ElectricResistance</span><span class='tstring_end'>&#39;</span></span>
          <span class='id identifier rubyid_query'>query</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>SELECT SUM(Value) FROM TabularDataWithStrings WHERE ReportName=&#39;ComponentSizingSummary&#39; AND ReportForString=&#39;Entire Facility&#39; AND TableName=&#39;ZONEHVAC:BASEBOARD:CONVECTIVE:ELECTRIC&#39; AND ColumnName=&#39;User-Specified Heating Design Capacity&#39; AND Units=&#39;W&#39;</span><span class='tstring_end'>&quot;</span></span>
        <span class='kw'>else</span>
          <span class='id identifier rubyid_query'>query</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>SELECT SUM(Value) FROM TabularDataWithStrings WHERE ReportName=&#39;ComponentSizingSummary&#39; AND ReportForString=&#39;Entire Facility&#39; AND TableName LIKE &#39;Coil:Heating:%&#39; AND ColumnName=&#39;User-Specified Nominal Capacity&#39; AND Units=&#39;W&#39;</span><span class='tstring_end'>&quot;</span></span>
        <span class='kw'>end</span>
        <span class='id identifier rubyid_sql_value'>sql_value</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="UnitConversions.html" title="UnitConversions (class)">UnitConversions</a></span></span><span class='period'>.</span><span class='id identifier rubyid_convert'><span class='object_link'><a href="UnitConversions.html#convert-class_method" title="UnitConversions.convert (method)">convert</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_sqlFile'>sqlFile</span><span class='period'>.</span><span class='id identifier rubyid_execAndReturnFirstDouble'>execAndReturnFirstDouble</span><span class='lparen'>(</span><span class='id identifier rubyid_query'>query</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_get'>get</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>W</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Btu/hr</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
        <span class='id identifier rubyid_assert_in_epsilon'>assert_in_epsilon</span><span class='lparen'>(</span><span class='id identifier rubyid_hpxml_value'>hpxml_value</span><span class='comma'>,</span> <span class='id identifier rubyid_sql_value'>sql_value</span><span class='comma'>,</span> <span class='float'>0.01</span><span class='rparen'>)</span>
      <span class='kw'>end</span>

      <span class='comment'># Electric Auxiliary Energy
</span>      <span class='comment'># FIXME: For now, skip if multiple equipment
</span>      <span class='kw'>if</span> <span class='id identifier rubyid_num_htg_sys'>num_htg_sys</span> <span class='op'>==</span> <span class='int'>1</span> <span class='kw'>and</span> <span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Furnace</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Boiler</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>WallFurnace</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Stove</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_include?'>include?</span> <span class='id identifier rubyid_htg_sys_type'>htg_sys_type</span> <span class='kw'>and</span> <span class='id identifier rubyid_htg_sys_fuel'>htg_sys_fuel</span> <span class='op'>!=</span> <span class='const'><span class='object_link'><a href="Constants.html" title="Constants (class)">Constants</a></span></span><span class='period'>.</span><span class='const'><span class='object_link'><a href="Constants.html#FuelTypeElectric-class_method" title="Constants.FuelTypeElectric (method)">FuelTypeElectric</a></span></span>
        <span class='kw'>if</span> <span class='const'><span class='object_link'><a href="XMLHelper.html" title="XMLHelper (class)">XMLHelper</a></span></span><span class='period'>.</span><span class='id identifier rubyid_has_element'><span class='object_link'><a href="XMLHelper.html#has_element-class_method" title="XMLHelper.has_element (method)">has_element</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_htg_sys'>htg_sys</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>ElectricAuxiliaryEnergy</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
          <span class='id identifier rubyid_hpxml_value'>hpxml_value</span> <span class='op'>=</span> <span class='const'>Float</span><span class='lparen'>(</span><span class='const'><span class='object_link'><a href="XMLHelper.html" title="XMLHelper (class)">XMLHelper</a></span></span><span class='period'>.</span><span class='id identifier rubyid_get_value'><span class='object_link'><a href="XMLHelper.html#get_value-class_method" title="XMLHelper.get_value (method)">get_value</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_htg_sys'>htg_sys</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>ElectricAuxiliaryEnergy</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span><span class='rparen'>)</span> <span class='op'>/</span> <span class='lparen'>(</span><span class='float'>2.08</span> <span class='op'>*</span> <span class='id identifier rubyid_htg_dse'>htg_dse</span><span class='rparen'>)</span>
        <span class='kw'>else</span>
          <span class='id identifier rubyid_furnace_capacity_kbtuh'>furnace_capacity_kbtuh</span> <span class='op'>=</span> <span class='kw'>nil</span>
          <span class='kw'>if</span> <span class='id identifier rubyid_htg_sys_type'>htg_sys_type</span> <span class='op'>==</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Furnace</span><span class='tstring_end'>&#39;</span></span>
            <span class='id identifier rubyid_query'>query</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>SELECT Value FROM TabularDataWithStrings WHERE ReportName=&#39;EquipmentSummary&#39; AND ReportForString=&#39;Entire Facility&#39; AND TableName=&#39;Heating Coils&#39; AND RowName LIKE &#39;%</span><span class='embexpr_beg'>#{</span><span class='const'><span class='object_link'><a href="Constants.html" title="Constants (class)">Constants</a></span></span><span class='period'>.</span><span class='const'><span class='object_link'><a href="Constants.html#ObjectNameFurnace-class_method" title="Constants.ObjectNameFurnace (method)">ObjectNameFurnace</a></span></span><span class='period'>.</span><span class='id identifier rubyid_upcase'>upcase</span><span class='embexpr_end'>}</span><span class='tstring_content'>%&#39; AND ColumnName=&#39;Nominal Total Capacity&#39; AND Units=&#39;W&#39;</span><span class='tstring_end'>&quot;</span></span>
            <span class='id identifier rubyid_furnace_capacity_kbtuh'>furnace_capacity_kbtuh</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="UnitConversions.html" title="UnitConversions (class)">UnitConversions</a></span></span><span class='period'>.</span><span class='id identifier rubyid_convert'><span class='object_link'><a href="UnitConversions.html#convert-class_method" title="UnitConversions.convert (method)">convert</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_sqlFile'>sqlFile</span><span class='period'>.</span><span class='id identifier rubyid_execAndReturnFirstDouble'>execAndReturnFirstDouble</span><span class='lparen'>(</span><span class='id identifier rubyid_query'>query</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_get'>get</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>W</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>kBtu/hr</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
          <span class='kw'>end</span>
          <span class='id identifier rubyid_hpxml_value'>hpxml_value</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="HVAC.html" title="HVAC (class)">HVAC</a></span></span><span class='period'>.</span><span class='id identifier rubyid_get_default_eae'><span class='object_link'><a href="HVAC.html#get_default_eae-class_method" title="HVAC.get_default_eae (method)">get_default_eae</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_htg_sys_type'>htg_sys_type</span> <span class='op'>==</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Boiler</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_htg_sys_type'>htg_sys_type</span> <span class='op'>==</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Furnace</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_htg_sys_fuel'>htg_sys_fuel</span><span class='comma'>,</span> <span class='float'>1.0</span><span class='comma'>,</span> <span class='id identifier rubyid_furnace_capacity_kbtuh'>furnace_capacity_kbtuh</span><span class='rparen'>)</span> <span class='op'>/</span> <span class='lparen'>(</span><span class='float'>2.08</span> <span class='op'>*</span> <span class='id identifier rubyid_htg_dse'>htg_dse</span><span class='rparen'>)</span>
        <span class='kw'>end</span>

        <span class='kw'>if</span> <span class='id identifier rubyid_htg_sys_type'>htg_sys_type</span> <span class='op'>==</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Boiler</span><span class='tstring_end'>&#39;</span></span>
          <span class='id identifier rubyid_query'>query</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>SELECT Value FROM TabularDataWithStrings WHERE ReportName=&#39;EquipmentSummary&#39; AND ReportForString=&#39;Entire Facility&#39; AND TableName=&#39;Pumps&#39; AND RowName LIKE &#39;%</span><span class='embexpr_beg'>#{</span><span class='const'><span class='object_link'><a href="Constants.html" title="Constants (class)">Constants</a></span></span><span class='period'>.</span><span class='const'><span class='object_link'><a href="Constants.html#ObjectNameBoiler-class_method" title="Constants.ObjectNameBoiler (method)">ObjectNameBoiler</a></span></span><span class='period'>.</span><span class='id identifier rubyid_upcase'>upcase</span><span class='embexpr_end'>}</span><span class='tstring_content'>%&#39; AND ColumnName=&#39;Electric Power&#39; AND Units=&#39;W&#39;</span><span class='tstring_end'>&quot;</span></span>
          <span class='id identifier rubyid_sql_value'>sql_value</span> <span class='op'>=</span> <span class='id identifier rubyid_sqlFile'>sqlFile</span><span class='period'>.</span><span class='id identifier rubyid_execAndReturnFirstDouble'>execAndReturnFirstDouble</span><span class='lparen'>(</span><span class='id identifier rubyid_query'>query</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_get'>get</span>
        <span class='kw'>elsif</span> <span class='id identifier rubyid_htg_sys_type'>htg_sys_type</span> <span class='op'>==</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Furnace</span><span class='tstring_end'>&#39;</span></span>
          <span class='comment'># Ratio fan power based on heating airflow rate divided by fan airflow rate since the
</span>          <span class='comment'># fan be sized based on cooling.
</span>          <span class='id identifier rubyid_query'>query</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>SELECT Value FROM TabularDataWithStrings WHERE ReportName=&#39;EquipmentSummary&#39; AND ReportForString=&#39;Entire Facility&#39; AND TableName=&#39;Fans&#39; AND RowName LIKE &#39;%</span><span class='embexpr_beg'>#{</span><span class='const'><span class='object_link'><a href="Constants.html" title="Constants (class)">Constants</a></span></span><span class='period'>.</span><span class='const'><span class='object_link'><a href="Constants.html#ObjectNameFurnace-class_method" title="Constants.ObjectNameFurnace (method)">ObjectNameFurnace</a></span></span><span class='period'>.</span><span class='id identifier rubyid_upcase'>upcase</span><span class='embexpr_end'>}</span><span class='tstring_content'>%&#39; AND ColumnName=&#39;Rated Electric Power&#39; AND Units=&#39;W&#39;</span><span class='tstring_end'>&quot;</span></span>
          <span class='id identifier rubyid_query_fan_airflow'>query_fan_airflow</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>SELECT Value FROM TabularDataWithStrings WHERE ReportName=&#39;ComponentSizingSummary&#39; AND ReportForString=&#39;Entire Facility&#39; AND TableName=&#39;Fan:OnOff&#39; AND RowName LIKE &#39;%</span><span class='embexpr_beg'>#{</span><span class='const'><span class='object_link'><a href="Constants.html" title="Constants (class)">Constants</a></span></span><span class='period'>.</span><span class='const'><span class='object_link'><a href="Constants.html#ObjectNameFurnace-class_method" title="Constants.ObjectNameFurnace (method)">ObjectNameFurnace</a></span></span><span class='period'>.</span><span class='id identifier rubyid_upcase'>upcase</span><span class='embexpr_end'>}</span><span class='tstring_content'>%&#39; AND ColumnName=&#39;User-Specified Maximum Flow Rate&#39; AND Units=&#39;m3/s&#39;</span><span class='tstring_end'>&quot;</span></span>
          <span class='id identifier rubyid_query_htg_airflow'>query_htg_airflow</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>SELECT Value FROM TabularDataWithStrings WHERE ReportName=&#39;ComponentSizingSummary&#39; AND ReportForString=&#39;Entire Facility&#39; AND TableName=&#39;AirLoopHVAC:UnitarySystem&#39; AND RowName LIKE &#39;%</span><span class='embexpr_beg'>#{</span><span class='const'><span class='object_link'><a href="Constants.html" title="Constants (class)">Constants</a></span></span><span class='period'>.</span><span class='const'><span class='object_link'><a href="Constants.html#ObjectNameFurnace-class_method" title="Constants.ObjectNameFurnace (method)">ObjectNameFurnace</a></span></span><span class='period'>.</span><span class='id identifier rubyid_upcase'>upcase</span><span class='embexpr_end'>}</span><span class='tstring_content'>%&#39; AND ColumnName=&#39;User-Specified Heating Supply Air Flow Rate&#39; AND Units=&#39;m3/s&#39;</span><span class='tstring_end'>&quot;</span></span>
          <span class='id identifier rubyid_sql_value'>sql_value</span> <span class='op'>=</span> <span class='id identifier rubyid_sqlFile'>sqlFile</span><span class='period'>.</span><span class='id identifier rubyid_execAndReturnFirstDouble'>execAndReturnFirstDouble</span><span class='lparen'>(</span><span class='id identifier rubyid_query'>query</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_get'>get</span>
          <span class='id identifier rubyid_sql_value_fan_airflow'>sql_value_fan_airflow</span> <span class='op'>=</span> <span class='id identifier rubyid_sqlFile'>sqlFile</span><span class='period'>.</span><span class='id identifier rubyid_execAndReturnFirstDouble'>execAndReturnFirstDouble</span><span class='lparen'>(</span><span class='id identifier rubyid_query_fan_airflow'>query_fan_airflow</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_get'>get</span>
          <span class='id identifier rubyid_sql_value_htg_airflow'>sql_value_htg_airflow</span> <span class='op'>=</span> <span class='id identifier rubyid_sqlFile'>sqlFile</span><span class='period'>.</span><span class='id identifier rubyid_execAndReturnFirstDouble'>execAndReturnFirstDouble</span><span class='lparen'>(</span><span class='id identifier rubyid_query_htg_airflow'>query_htg_airflow</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_get'>get</span>
          <span class='id identifier rubyid_sql_value'>sql_value</span> <span class='op'>*=</span> <span class='id identifier rubyid_sql_value_htg_airflow'>sql_value_htg_airflow</span> <span class='op'>/</span> <span class='id identifier rubyid_sql_value_fan_airflow'>sql_value_fan_airflow</span>
        <span class='kw'>elsif</span> <span class='id identifier rubyid_htg_sys_type'>htg_sys_type</span> <span class='op'>==</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Stove</span><span class='tstring_end'>&#39;</span></span> <span class='kw'>or</span> <span class='id identifier rubyid_htg_sys_type'>htg_sys_type</span> <span class='op'>==</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>WallFurnace</span><span class='tstring_end'>&#39;</span></span>
          <span class='id identifier rubyid_query'>query</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>SELECT AVG(Value) FROM TabularDataWithStrings WHERE ReportName=&#39;EquipmentSummary&#39; AND ReportForString=&#39;Entire Facility&#39; AND TableName=&#39;Fans&#39; AND RowName LIKE &#39;%</span><span class='embexpr_beg'>#{</span><span class='const'><span class='object_link'><a href="Constants.html" title="Constants (class)">Constants</a></span></span><span class='period'>.</span><span class='const'><span class='object_link'><a href="Constants.html#ObjectNameUnitHeater-class_method" title="Constants.ObjectNameUnitHeater (method)">ObjectNameUnitHeater</a></span></span><span class='period'>.</span><span class='id identifier rubyid_upcase'>upcase</span><span class='embexpr_end'>}</span><span class='tstring_content'>%&#39; AND ColumnName=&#39;Rated Electric Power&#39; AND Units=&#39;W&#39;</span><span class='tstring_end'>&quot;</span></span>
          <span class='id identifier rubyid_sql_value'>sql_value</span> <span class='op'>=</span> <span class='id identifier rubyid_sqlFile'>sqlFile</span><span class='period'>.</span><span class='id identifier rubyid_execAndReturnFirstDouble'>execAndReturnFirstDouble</span><span class='lparen'>(</span><span class='id identifier rubyid_query'>query</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_get'>get</span>
        <span class='kw'>else</span>
          <span class='id identifier rubyid_flunk'>flunk</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Unexpected heating system type &#39;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_htg_sys_type'>htg_sys_type</span><span class='embexpr_end'>}</span><span class='tstring_content'>&#39;.</span><span class='tstring_end'>&quot;</span></span>
        <span class='kw'>end</span>
        <span class='id identifier rubyid_assert_in_epsilon'>assert_in_epsilon</span><span class='lparen'>(</span><span class='id identifier rubyid_hpxml_value'>hpxml_value</span><span class='comma'>,</span> <span class='id identifier rubyid_sql_value'>sql_value</span><span class='comma'>,</span> <span class='float'>0.01</span><span class='rparen'>)</span>

        <span class='kw'>if</span> <span class='id identifier rubyid_htg_sys_type'>htg_sys_type</span> <span class='op'>==</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Furnace</span><span class='tstring_end'>&#39;</span></span>
          <span class='comment'># Also check supply fan of cooling system as needed
</span>          <span class='id identifier rubyid_htg_dist'>htg_dist</span> <span class='op'>=</span> <span class='id identifier rubyid_htg_sys'>htg_sys</span><span class='period'>.</span><span class='id identifier rubyid_elements'>elements</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>DistributionSystem</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span>
          <span class='id identifier rubyid_bldg_details'>bldg_details</span><span class='period'>.</span><span class='id identifier rubyid_elements'>elements</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Systems/HVAC/HVACPlant/CoolingSystem[FractionCoolLoadServed &gt; 0]</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_clg_sys'>clg_sys</span><span class='op'>|</span>
            <span class='id identifier rubyid_clg_dist'>clg_dist</span> <span class='op'>=</span> <span class='id identifier rubyid_clg_sys'>clg_sys</span><span class='period'>.</span><span class='id identifier rubyid_elements'>elements</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>DistributionSystem</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span>
            <span class='kw'>next</span> <span class='kw'>if</span> <span class='id identifier rubyid_htg_dist'>htg_dist</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span> <span class='kw'>or</span> <span class='id identifier rubyid_clg_dist'>clg_dist</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span>
            <span class='kw'>next</span> <span class='kw'>if</span> <span class='id identifier rubyid_clg_dist'>clg_dist</span><span class='period'>.</span><span class='id identifier rubyid_attributes'>attributes</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>idref</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='op'>!=</span> <span class='id identifier rubyid_htg_dist'>htg_dist</span><span class='period'>.</span><span class='id identifier rubyid_attributes'>attributes</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>idref</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span>

            <span class='id identifier rubyid_clg_sys_type'>clg_sys_type</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="XMLHelper.html" title="XMLHelper (class)">XMLHelper</a></span></span><span class='period'>.</span><span class='id identifier rubyid_get_value'><span class='object_link'><a href="XMLHelper.html#get_value-class_method" title="XMLHelper.get_value (method)">get_value</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_clg_sys'>clg_sys</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>CoolingSystemType</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
            <span class='kw'>if</span> <span class='id identifier rubyid_clg_sys_type'>clg_sys_type</span> <span class='op'>==</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>central air conditioning</span><span class='tstring_end'>&#39;</span></span>
              <span class='id identifier rubyid_query_w'>query_w</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>SELECT Value FROM TabularDataWithStrings WHERE ReportName=&#39;EquipmentSummary&#39; AND ReportForString=&#39;Entire Facility&#39; AND TableName=&#39;Fans&#39; AND RowName LIKE &#39;%</span><span class='embexpr_beg'>#{</span><span class='const'><span class='object_link'><a href="Constants.html" title="Constants (class)">Constants</a></span></span><span class='period'>.</span><span class='const'><span class='object_link'><a href="Constants.html#ObjectNameCentralAirConditioner-class_method" title="Constants.ObjectNameCentralAirConditioner (method)">ObjectNameCentralAirConditioner</a></span></span><span class='period'>.</span><span class='id identifier rubyid_upcase'>upcase</span><span class='embexpr_end'>}</span><span class='tstring_content'>%&#39; AND ColumnName=&#39;Rated Electric Power&#39; AND Units=&#39;W&#39;</span><span class='tstring_end'>&quot;</span></span>
              <span class='id identifier rubyid_sql_value_w'>sql_value_w</span> <span class='op'>=</span> <span class='id identifier rubyid_sqlFile'>sqlFile</span><span class='period'>.</span><span class='id identifier rubyid_execAndReturnFirstDouble'>execAndReturnFirstDouble</span><span class='lparen'>(</span><span class='id identifier rubyid_query_w'>query_w</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_get'>get</span>
              <span class='id identifier rubyid_sql_value'>sql_value</span> <span class='op'>=</span> <span class='id identifier rubyid_sql_value_w'>sql_value_w</span> <span class='op'>*</span> <span class='id identifier rubyid_sql_value_htg_airflow'>sql_value_htg_airflow</span> <span class='op'>/</span> <span class='id identifier rubyid_sql_value_fan_airflow'>sql_value_fan_airflow</span>
              <span class='id identifier rubyid_assert_in_epsilon'>assert_in_epsilon</span><span class='lparen'>(</span><span class='id identifier rubyid_hpxml_value'>hpxml_value</span><span class='comma'>,</span> <span class='id identifier rubyid_sql_value'>sql_value</span><span class='comma'>,</span> <span class='float'>0.01</span><span class='rparen'>)</span>
            <span class='kw'>else</span>
              <span class='id identifier rubyid_flunk'>flunk</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Unexpected cooling system type: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_clg_sys_type'>clg_sys_type</span><span class='embexpr_end'>}</span><span class='tstring_content'>.</span><span class='tstring_end'>&quot;</span></span>
            <span class='kw'>end</span>
          <span class='kw'>end</span>
        <span class='kw'>end</span>
      <span class='kw'>end</span>

    <span class='kw'>end</span>
  <span class='kw'>end</span>

  <span class='comment'># HVAC Cooling Systems
</span>  <span class='id identifier rubyid_num_clg_sys'>num_clg_sys</span> <span class='op'>=</span> <span class='id identifier rubyid_bldg_details'>bldg_details</span><span class='period'>.</span><span class='id identifier rubyid_elements'>elements</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>count(Systems/HVAC/HVACPlant/CoolingSystem)</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span>
  <span class='id identifier rubyid_bldg_details'>bldg_details</span><span class='period'>.</span><span class='id identifier rubyid_elements'>elements</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Systems/HVAC/HVACPlant/CoolingSystem</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_clg_sys'>clg_sys</span><span class='op'>|</span>
    <span class='id identifier rubyid_clg_sys_type'>clg_sys_type</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="XMLHelper.html" title="XMLHelper (class)">XMLHelper</a></span></span><span class='period'>.</span><span class='id identifier rubyid_get_value'><span class='object_link'><a href="XMLHelper.html#get_value-class_method" title="XMLHelper.get_value (method)">get_value</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_clg_sys'>clg_sys</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>CoolingSystemType</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
    <span class='id identifier rubyid_clg_sys_cap'>clg_sys_cap</span> <span class='op'>=</span> <span class='const'>Float</span><span class='lparen'>(</span><span class='const'><span class='object_link'><a href="XMLHelper.html" title="XMLHelper (class)">XMLHelper</a></span></span><span class='period'>.</span><span class='id identifier rubyid_get_value'><span class='object_link'><a href="XMLHelper.html#get_value-class_method" title="XMLHelper.get_value (method)">get_value</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_clg_sys'>clg_sys</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>CoolingCapacity</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_clg_sys_seer'>clg_sys_seer</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="XMLHelper.html" title="XMLHelper (class)">XMLHelper</a></span></span><span class='period'>.</span><span class='id identifier rubyid_get_value'><span class='object_link'><a href="XMLHelper.html#get_value-class_method" title="XMLHelper.get_value (method)">get_value</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_clg_sys'>clg_sys</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>AnnualCoolingEfficiency[Units=&#39;SEER&#39;]/Value</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
    <span class='id identifier rubyid_clg_sys_seer'>clg_sys_seer</span> <span class='op'>=</span> <span class='const'>Float</span><span class='lparen'>(</span><span class='id identifier rubyid_clg_sys_seer'>clg_sys_seer</span><span class='rparen'>)</span> <span class='kw'>if</span> <span class='kw'>not</span> <span class='id identifier rubyid_clg_sys_seer'>clg_sys_seer</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span>
    <span class='id identifier rubyid_clg_load_frac'>clg_load_frac</span> <span class='op'>=</span> <span class='const'>Float</span><span class='lparen'>(</span><span class='const'><span class='object_link'><a href="XMLHelper.html" title="XMLHelper (class)">XMLHelper</a></span></span><span class='period'>.</span><span class='id identifier rubyid_get_value'><span class='object_link'><a href="XMLHelper.html#get_value-class_method" title="XMLHelper.get_value (method)">get_value</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_clg_sys'>clg_sys</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>FractionCoolLoadServed</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span><span class='rparen'>)</span>

    <span class='kw'>if</span> <span class='id identifier rubyid_clg_load_frac'>clg_load_frac</span> <span class='op'>&lt;=</span> <span class='int'>0</span>

      <span class='comment'># Cooling Load Fraction
</span>      <span class='comment'># Check for zero cooling energy
</span>      <span class='id identifier rubyid_found_clg_energy'>found_clg_energy</span> <span class='op'>=</span> <span class='kw'>false</span>
      <span class='id identifier rubyid_results'>results</span><span class='period'>.</span><span class='id identifier rubyid_keys'>keys</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_k'>k</span><span class='op'>|</span>
        <span class='kw'>next</span> <span class='kw'>unless</span> <span class='id identifier rubyid_k'>k</span><span class='lbracket'>[</span><span class='int'>1</span><span class='rbracket'>]</span> <span class='op'>==</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Cooling</span><span class='tstring_end'>&#39;</span></span>

        <span class='id identifier rubyid_found_clg_energy'>found_clg_energy</span> <span class='op'>=</span> <span class='kw'>true</span>
      <span class='kw'>end</span>
      <span class='id identifier rubyid_assert_equal'>assert_equal</span><span class='lparen'>(</span><span class='kw'>false</span><span class='comma'>,</span> <span class='id identifier rubyid_found_clg_energy'>found_clg_energy</span><span class='rparen'>)</span>

    <span class='kw'>else</span>

      <span class='comment'># Cooling Capacity
</span>      <span class='comment'># FIXME: For now, skip if multiple equipment
</span>      <span class='kw'>if</span> <span class='id identifier rubyid_clg_sys_cap'>clg_sys_cap</span> <span class='op'>&gt;</span> <span class='int'>0</span> <span class='kw'>and</span> <span class='id identifier rubyid_num_clg_sys'>num_clg_sys</span> <span class='op'>==</span> <span class='int'>1</span>
        <span class='id identifier rubyid_hpxml_value'>hpxml_value</span> <span class='op'>=</span> <span class='id identifier rubyid_clg_sys_cap'>clg_sys_cap</span>
        <span class='id identifier rubyid_query'>query</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>SELECT SUM(Value) FROM TabularDataWithStrings WHERE ReportName=&#39;ComponentSizingSummary&#39; AND ReportForString=&#39;Entire Facility&#39; AND TableName LIKE &#39;Coil:Cooling:%&#39; AND ColumnName LIKE &#39;%User-Specified%Total Cooling Capacity&#39; AND Units=&#39;W&#39;</span><span class='tstring_end'>&quot;</span></span>
        <span class='id identifier rubyid_sql_value'>sql_value</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="UnitConversions.html" title="UnitConversions (class)">UnitConversions</a></span></span><span class='period'>.</span><span class='id identifier rubyid_convert'><span class='object_link'><a href="UnitConversions.html#convert-class_method" title="UnitConversions.convert (method)">convert</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_sqlFile'>sqlFile</span><span class='period'>.</span><span class='id identifier rubyid_execAndReturnFirstDouble'>execAndReturnFirstDouble</span><span class='lparen'>(</span><span class='id identifier rubyid_query'>query</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_get'>get</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>W</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Btu/hr</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
        <span class='kw'>if</span> <span class='id identifier rubyid_clg_sys_type'>clg_sys_type</span> <span class='op'>==</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>central air conditioning</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>and</span> <span class='id identifier rubyid_get_ac_num_speeds'><span class='object_link'><a href="top-level-namespace.html#get_ac_num_speeds-instance_method" title="#get_ac_num_speeds (method)">get_ac_num_speeds</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_clg_sys_seer'>clg_sys_seer</span><span class='rparen'>)</span> <span class='op'>==</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Variable-Speed</span><span class='tstring_end'>&quot;</span></span>
          <span class='id identifier rubyid_cap_adj'>cap_adj</span> <span class='op'>=</span> <span class='float'>1.16</span> <span class='comment'># TODO: Generalize this
</span>        <span class='kw'>else</span>
          <span class='id identifier rubyid_cap_adj'>cap_adj</span> <span class='op'>=</span> <span class='float'>1.0</span>
        <span class='kw'>end</span>
        <span class='id identifier rubyid_assert_in_epsilon'>assert_in_epsilon</span><span class='lparen'>(</span><span class='id identifier rubyid_hpxml_value'>hpxml_value</span> <span class='op'>*</span> <span class='id identifier rubyid_cap_adj'>cap_adj</span><span class='comma'>,</span> <span class='id identifier rubyid_sql_value'>sql_value</span><span class='comma'>,</span> <span class='float'>0.01</span><span class='rparen'>)</span>
      <span class='kw'>end</span>

    <span class='kw'>end</span>
  <span class='kw'>end</span>

  <span class='comment'># HVAC Heat Pumps
</span>  <span class='id identifier rubyid_num_hp'>num_hp</span> <span class='op'>=</span> <span class='id identifier rubyid_bldg_details'>bldg_details</span><span class='period'>.</span><span class='id identifier rubyid_elements'>elements</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>count(Systems/HVAC/HVACPlant/HeatPump)</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span>
  <span class='id identifier rubyid_bldg_details'>bldg_details</span><span class='period'>.</span><span class='id identifier rubyid_elements'>elements</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Systems/HVAC/HVACPlant/HeatPump</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_hp'>hp</span><span class='op'>|</span>
    <span class='id identifier rubyid_hp_type'>hp_type</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="XMLHelper.html" title="XMLHelper (class)">XMLHelper</a></span></span><span class='period'>.</span><span class='id identifier rubyid_get_value'><span class='object_link'><a href="XMLHelper.html#get_value-class_method" title="XMLHelper.get_value (method)">get_value</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_hp'>hp</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>HeatPumpType</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
    <span class='id identifier rubyid_hp_cap'>hp_cap</span> <span class='op'>=</span> <span class='const'>Float</span><span class='lparen'>(</span><span class='const'><span class='object_link'><a href="XMLHelper.html" title="XMLHelper (class)">XMLHelper</a></span></span><span class='period'>.</span><span class='id identifier rubyid_get_value'><span class='object_link'><a href="XMLHelper.html#get_value-class_method" title="XMLHelper.get_value (method)">get_value</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_hp'>hp</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>CoolingCapacity</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_hp_seer'>hp_seer</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="XMLHelper.html" title="XMLHelper (class)">XMLHelper</a></span></span><span class='period'>.</span><span class='id identifier rubyid_get_value'><span class='object_link'><a href="XMLHelper.html#get_value-class_method" title="XMLHelper.get_value (method)">get_value</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_hp'>hp</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>AnnualCoolingEfficiency[Units=&#39;SEER&#39;]/Value</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
    <span class='id identifier rubyid_hp_seer'>hp_seer</span> <span class='op'>=</span> <span class='const'>Float</span><span class='lparen'>(</span><span class='id identifier rubyid_hp_seer'>hp_seer</span><span class='rparen'>)</span> <span class='kw'>if</span> <span class='kw'>not</span> <span class='id identifier rubyid_hp_seer'>hp_seer</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span>
    <span class='id identifier rubyid_hp_htg_load_frac'>hp_htg_load_frac</span> <span class='op'>=</span> <span class='const'>Float</span><span class='lparen'>(</span><span class='const'><span class='object_link'><a href="XMLHelper.html" title="XMLHelper (class)">XMLHelper</a></span></span><span class='period'>.</span><span class='id identifier rubyid_get_value'><span class='object_link'><a href="XMLHelper.html#get_value-class_method" title="XMLHelper.get_value (method)">get_value</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_hp'>hp</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>FractionHeatLoadServed</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_hp_clg_load_frac'>hp_clg_load_frac</span> <span class='op'>=</span> <span class='const'>Float</span><span class='lparen'>(</span><span class='const'><span class='object_link'><a href="XMLHelper.html" title="XMLHelper (class)">XMLHelper</a></span></span><span class='period'>.</span><span class='id identifier rubyid_get_value'><span class='object_link'><a href="XMLHelper.html#get_value-class_method" title="XMLHelper.get_value (method)">get_value</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_hp'>hp</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>FractionCoolLoadServed</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span><span class='rparen'>)</span>

    <span class='kw'>if</span> <span class='id identifier rubyid_hp_htg_load_frac'>hp_htg_load_frac</span> <span class='op'>&lt;=</span> <span class='int'>0</span>

      <span class='comment'># Heating Load Fraction
</span>      <span class='comment'># Check for zero heating energy
</span>      <span class='id identifier rubyid_found_htg_energy'>found_htg_energy</span> <span class='op'>=</span> <span class='kw'>false</span>
      <span class='id identifier rubyid_results'>results</span><span class='period'>.</span><span class='id identifier rubyid_keys'>keys</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_k'>k</span><span class='op'>|</span>
        <span class='kw'>next</span> <span class='kw'>unless</span> <span class='id identifier rubyid_k'>k</span><span class='lbracket'>[</span><span class='int'>1</span><span class='rbracket'>]</span> <span class='op'>==</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Heating</span><span class='tstring_end'>&#39;</span></span>

        <span class='id identifier rubyid_found_htg_energy'>found_htg_energy</span> <span class='op'>=</span> <span class='kw'>true</span>
      <span class='kw'>end</span>
      <span class='id identifier rubyid_assert_equal'>assert_equal</span><span class='lparen'>(</span><span class='kw'>false</span><span class='comma'>,</span> <span class='id identifier rubyid_found_htg_energy'>found_htg_energy</span><span class='rparen'>)</span>

    <span class='kw'>end</span>

    <span class='kw'>if</span> <span class='id identifier rubyid_hp_clg_load_frac'>hp_clg_load_frac</span> <span class='op'>&lt;=</span> <span class='int'>0</span>

      <span class='comment'># Cooling Load Fraction
</span>      <span class='comment'># Check for zero cooling energy
</span>      <span class='id identifier rubyid_found_clg_energy'>found_clg_energy</span> <span class='op'>=</span> <span class='kw'>false</span>
      <span class='id identifier rubyid_results'>results</span><span class='period'>.</span><span class='id identifier rubyid_keys'>keys</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_k'>k</span><span class='op'>|</span>
        <span class='kw'>next</span> <span class='kw'>unless</span> <span class='id identifier rubyid_k'>k</span><span class='lbracket'>[</span><span class='int'>1</span><span class='rbracket'>]</span> <span class='op'>==</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Cooling</span><span class='tstring_end'>&#39;</span></span>

        <span class='id identifier rubyid_found_clg_energy'>found_clg_energy</span> <span class='op'>=</span> <span class='kw'>true</span>
      <span class='kw'>end</span>
      <span class='id identifier rubyid_assert_equal'>assert_equal</span><span class='lparen'>(</span><span class='kw'>false</span><span class='comma'>,</span> <span class='id identifier rubyid_found_clg_energy'>found_clg_energy</span><span class='rparen'>)</span>

    <span class='kw'>else</span>

      <span class='comment'># Cooling Capacity
</span>      <span class='comment'># FIXME: For now, skip if multiple equipment
</span>      <span class='kw'>if</span> <span class='id identifier rubyid_hp_cap'>hp_cap</span> <span class='op'>&gt;</span> <span class='int'>0</span> <span class='kw'>and</span> <span class='id identifier rubyid_num_hp'>num_hp</span> <span class='op'>==</span> <span class='int'>1</span>
        <span class='id identifier rubyid_hpxml_value'>hpxml_value</span> <span class='op'>=</span> <span class='id identifier rubyid_hp_cap'>hp_cap</span>
        <span class='id identifier rubyid_query'>query</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>SELECT SUM(Value) FROM TabularDataWithStrings WHERE ReportName=&#39;ComponentSizingSummary&#39; AND ReportForString=&#39;Entire Facility&#39; AND TableName LIKE &#39;Coil:Cooling:%&#39; AND ColumnName LIKE &#39;%User-Specified%Total Cooling Capacity&#39; AND Units=&#39;W&#39;</span><span class='tstring_end'>&quot;</span></span>
        <span class='id identifier rubyid_sql_value'>sql_value</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="UnitConversions.html" title="UnitConversions (class)">UnitConversions</a></span></span><span class='period'>.</span><span class='id identifier rubyid_convert'><span class='object_link'><a href="UnitConversions.html#convert-class_method" title="UnitConversions.convert (method)">convert</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_sqlFile'>sqlFile</span><span class='period'>.</span><span class='id identifier rubyid_execAndReturnFirstDouble'>execAndReturnFirstDouble</span><span class='lparen'>(</span><span class='id identifier rubyid_query'>query</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_get'>get</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>W</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Btu/hr</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
        <span class='kw'>if</span> <span class='id identifier rubyid_hp_type'>hp_type</span> <span class='op'>==</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>mini-split</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>or</span> <span class='lparen'>(</span><span class='id identifier rubyid_hp_type'>hp_type</span> <span class='op'>==</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>air-to-air</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>and</span> <span class='id identifier rubyid_get_ashp_num_speeds'><span class='object_link'><a href="top-level-namespace.html#get_ashp_num_speeds-instance_method" title="#get_ashp_num_speeds (method)">get_ashp_num_speeds</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_hp_seer'>hp_seer</span><span class='rparen'>)</span> <span class='op'>==</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Variable-Speed</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
          <span class='id identifier rubyid_cap_adj'>cap_adj</span> <span class='op'>=</span> <span class='float'>1.20</span> <span class='comment'># TODO: Generalize this
</span>        <span class='kw'>else</span>
          <span class='id identifier rubyid_cap_adj'>cap_adj</span> <span class='op'>=</span> <span class='float'>1.0</span>
        <span class='kw'>end</span>
        <span class='id identifier rubyid_assert_in_epsilon'>assert_in_epsilon</span><span class='lparen'>(</span><span class='id identifier rubyid_hpxml_value'>hpxml_value</span> <span class='op'>*</span> <span class='id identifier rubyid_cap_adj'>cap_adj</span><span class='comma'>,</span> <span class='id identifier rubyid_sql_value'>sql_value</span><span class='comma'>,</span> <span class='float'>0.01</span><span class='rparen'>)</span>
      <span class='kw'>end</span>

    <span class='kw'>end</span>
  <span class='kw'>end</span>

  <span class='comment'># HVAC fan power
</span>  <span class='kw'>if</span> <span class='id identifier rubyid_bldg_details'>bldg_details</span><span class='period'>.</span><span class='id identifier rubyid_elements'>elements</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>count(Systems/HVAC/HVACDistribution/DistributionSystemType/AirDistribution)</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='op'>==</span> <span class='int'>1</span>

    <span class='id identifier rubyid_htg_fan_w_per_cfm'>htg_fan_w_per_cfm</span> <span class='op'>=</span> <span class='kw'>nil</span>
    <span class='kw'>if</span> <span class='id identifier rubyid_bldg_details'>bldg_details</span><span class='period'>.</span><span class='id identifier rubyid_elements'>elements</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>count(Systems/HVAC/HVACPlant/HeatingSystem[FractionHeatLoadServed &gt; 0] | Systems/HVAC/HVACPlant/HeatPump[FractionHeatLoadServed &gt; 0])</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='op'>==</span> <span class='int'>1</span>
      <span class='id identifier rubyid_bldg_details'>bldg_details</span><span class='period'>.</span><span class='id identifier rubyid_elements'>elements</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Systems/HVAC/HVACPlant/HeatingSystem[FractionHeatLoadServed &gt; 0] | Systems/HVAC/HVACPlant/HeatPump[FractionHeatLoadServed &gt; 0]</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_htg_sys'>htg_sys</span><span class='op'>|</span>
        <span class='kw'>next</span> <span class='kw'>unless</span> <span class='const'><span class='object_link'><a href="XMLHelper.html" title="XMLHelper (class)">XMLHelper</a></span></span><span class='period'>.</span><span class='id identifier rubyid_has_element'><span class='object_link'><a href="XMLHelper.html#has_element-class_method" title="XMLHelper.has_element (method)">has_element</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_htg_sys'>htg_sys</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>DistributionSystem</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>

        <span class='id identifier rubyid_query'>query</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>SELECT Value FROM TabularDataWithStrings WHERE ReportName=&#39;EquipmentSummary&#39; AND ReportForString=&#39;Entire Facility&#39; AND TableName=&#39;Fans&#39; AND RowName LIKE &#39;%HTG SUPPLY FAN%&#39; AND ColumnName=&#39;Rated Power Per Max Air Flow Rate&#39; AND Units=&#39;W-s/m3&#39;</span><span class='tstring_end'>&quot;</span></span>
        <span class='id identifier rubyid_htg_fan_w_per_cfm'>htg_fan_w_per_cfm</span> <span class='op'>=</span> <span class='id identifier rubyid_sqlFile'>sqlFile</span><span class='period'>.</span><span class='id identifier rubyid_execAndReturnFirstDouble'>execAndReturnFirstDouble</span><span class='lparen'>(</span><span class='id identifier rubyid_query'>query</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_get'>get</span> <span class='op'>/</span> <span class='const'><span class='object_link'><a href="UnitConversions.html" title="UnitConversions (class)">UnitConversions</a></span></span><span class='period'>.</span><span class='id identifier rubyid_convert'><span class='object_link'><a href="UnitConversions.html#convert-class_method" title="UnitConversions.convert (method)">convert</a></span></span><span class='lparen'>(</span><span class='float'>1.0</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>m^3/s</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>cfm</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
      <span class='kw'>end</span>
    <span class='kw'>end</span>

    <span class='id identifier rubyid_clg_fan_w_per_cfm'>clg_fan_w_per_cfm</span> <span class='op'>=</span> <span class='kw'>nil</span>
    <span class='kw'>if</span> <span class='id identifier rubyid_bldg_details'>bldg_details</span><span class='period'>.</span><span class='id identifier rubyid_elements'>elements</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>count(Systems/HVAC/HVACPlant/CoolingSystem[FractionCoolLoadServed &gt; 0] | Systems/HVAC/HVACPlant/HeatPump[FractionCoolLoadServed &gt; 0])</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='op'>==</span> <span class='int'>1</span>
      <span class='id identifier rubyid_bldg_details'>bldg_details</span><span class='period'>.</span><span class='id identifier rubyid_elements'>elements</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Systems/HVAC/HVACPlant/CoolingSystem[FractionCoolLoadServed &gt; 0] | Systems/HVAC/HVACPlant/HeatPump[FractionCoolLoadServed &gt; 0]</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_clg_sys'>clg_sys</span><span class='op'>|</span>
        <span class='kw'>next</span> <span class='kw'>unless</span> <span class='const'><span class='object_link'><a href="XMLHelper.html" title="XMLHelper (class)">XMLHelper</a></span></span><span class='period'>.</span><span class='id identifier rubyid_has_element'><span class='object_link'><a href="XMLHelper.html#has_element-class_method" title="XMLHelper.has_element (method)">has_element</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_clg_sys'>clg_sys</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>DistributionSystem</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>

        <span class='id identifier rubyid_query'>query</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>SELECT Value FROM TabularDataWithStrings WHERE ReportName=&#39;EquipmentSummary&#39; AND ReportForString=&#39;Entire Facility&#39; AND TableName=&#39;Fans&#39; AND RowName LIKE &#39;%CLG SUPPLY FAN%&#39; AND ColumnName=&#39;Rated Power Per Max Air Flow Rate&#39; AND Units=&#39;W-s/m3&#39;</span><span class='tstring_end'>&quot;</span></span>
        <span class='id identifier rubyid_clg_fan_w_per_cfm'>clg_fan_w_per_cfm</span> <span class='op'>=</span> <span class='id identifier rubyid_sqlFile'>sqlFile</span><span class='period'>.</span><span class='id identifier rubyid_execAndReturnFirstDouble'>execAndReturnFirstDouble</span><span class='lparen'>(</span><span class='id identifier rubyid_query'>query</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_get'>get</span> <span class='op'>/</span> <span class='const'><span class='object_link'><a href="UnitConversions.html" title="UnitConversions (class)">UnitConversions</a></span></span><span class='period'>.</span><span class='id identifier rubyid_convert'><span class='object_link'><a href="UnitConversions.html#convert-class_method" title="UnitConversions.convert (method)">convert</a></span></span><span class='lparen'>(</span><span class='float'>1.0</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>m^3/s</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>cfm</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
      <span class='kw'>end</span>
    <span class='kw'>end</span>

    <span class='kw'>if</span> <span class='kw'>not</span> <span class='id identifier rubyid_htg_fan_w_per_cfm'>htg_fan_w_per_cfm</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span> <span class='kw'>and</span> <span class='kw'>not</span> <span class='id identifier rubyid_clg_fan_w_per_cfm'>clg_fan_w_per_cfm</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span>
      <span class='comment'># Ensure associated heating &amp; cooling systems have same fan power
</span>      <span class='id identifier rubyid_assert_equal'>assert_equal</span><span class='lparen'>(</span><span class='id identifier rubyid_htg_fan_w_per_cfm'>htg_fan_w_per_cfm</span><span class='comma'>,</span> <span class='id identifier rubyid_clg_fan_w_per_cfm'>clg_fan_w_per_cfm</span><span class='rparen'>)</span>
    <span class='kw'>end</span>

    <span class='comment'># CFIS fan power
</span>    <span class='id identifier rubyid_cfis_fan_w_per_airflow'>cfis_fan_w_per_airflow</span> <span class='op'>=</span> <span class='kw'>nil</span>
    <span class='kw'>if</span> <span class='const'><span class='object_link'><a href="XMLHelper.html" title="XMLHelper (class)">XMLHelper</a></span></span><span class='period'>.</span><span class='id identifier rubyid_get_value'><span class='object_link'><a href="XMLHelper.html#get_value-class_method" title="XMLHelper.get_value (method)">get_value</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_bldg_details'>bldg_details</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Systems/MechanicalVentilation/VentilationFans/VentilationFan[UsedForWholeBuildingVentilation=&#39;true&#39;]/FanType</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span> <span class='op'>==</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>central fan integrated supply</span><span class='tstring_end'>&quot;</span></span>
      <span class='id identifier rubyid_query'>query</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>SELECT Value FROM ReportData WHERE ReportDataDictionaryIndex IN (SELECT ReportDataDictionaryIndex FROM ReportDataDictionary WHERE Name=&#39;res_mv_1_cfis_fan_power&#39;)</span><span class='tstring_end'>&quot;</span></span>
      <span class='id identifier rubyid_cfis_fan_w_per_cfm'>cfis_fan_w_per_cfm</span> <span class='op'>=</span> <span class='id identifier rubyid_sqlFile'>sqlFile</span><span class='period'>.</span><span class='id identifier rubyid_execAndReturnFirstDouble'>execAndReturnFirstDouble</span><span class='lparen'>(</span><span class='id identifier rubyid_query'>query</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_get'>get</span>
      <span class='comment'># Ensure CFIS fan power equals heating/cooling fan power
</span>      <span class='kw'>if</span> <span class='kw'>not</span> <span class='id identifier rubyid_htg_fan_w_per_cfm'>htg_fan_w_per_cfm</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span>
        <span class='id identifier rubyid_assert_in_delta'>assert_in_delta</span><span class='lparen'>(</span><span class='id identifier rubyid_htg_fan_w_per_cfm'>htg_fan_w_per_cfm</span><span class='comma'>,</span> <span class='id identifier rubyid_cfis_fan_w_per_cfm'>cfis_fan_w_per_cfm</span><span class='comma'>,</span> <span class='float'>0.001</span><span class='rparen'>)</span>
      <span class='kw'>else</span>
        <span class='id identifier rubyid_assert_in_delta'>assert_in_delta</span><span class='lparen'>(</span><span class='id identifier rubyid_clg_fan_w_per_cfm'>clg_fan_w_per_cfm</span><span class='comma'>,</span> <span class='id identifier rubyid_cfis_fan_w_per_cfm'>cfis_fan_w_per_cfm</span><span class='comma'>,</span> <span class='float'>0.001</span><span class='rparen'>)</span>
      <span class='kw'>end</span>
    <span class='kw'>end</span>

  <span class='kw'>end</span>

  <span class='comment'># Mechanical Ventilation
</span>  <span class='id identifier rubyid_mv'>mv</span> <span class='op'>=</span> <span class='id identifier rubyid_bldg_details'>bldg_details</span><span class='period'>.</span><span class='id identifier rubyid_elements'>elements</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Systems/MechanicalVentilation/VentilationFans/VentilationFan[UsedForWholeBuildingVentilation=&#39;true&#39;]</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span>
  <span class='kw'>if</span> <span class='kw'>not</span> <span class='id identifier rubyid_mv'>mv</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span>
    <span class='id identifier rubyid_found_mv_energy'>found_mv_energy</span> <span class='op'>=</span> <span class='kw'>false</span>
    <span class='id identifier rubyid_results'>results</span><span class='period'>.</span><span class='id identifier rubyid_keys'>keys</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_k'>k</span><span class='op'>|</span>
      <span class='kw'>next</span> <span class='kw'>if</span> <span class='id identifier rubyid_k'>k</span><span class='lbracket'>[</span><span class='int'>0</span><span class='rbracket'>]</span> <span class='op'>!=</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Electricity</span><span class='tstring_end'>&#39;</span></span> <span class='kw'>or</span> <span class='id identifier rubyid_k'>k</span><span class='lbracket'>[</span><span class='int'>1</span><span class='rbracket'>]</span> <span class='op'>!=</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Interior Equipment</span><span class='tstring_end'>&#39;</span></span> <span class='kw'>or</span> <span class='kw'>not</span> <span class='id identifier rubyid_k'>k</span><span class='lbracket'>[</span><span class='int'>2</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_start_with?'>start_with?</span> <span class='const'><span class='object_link'><a href="Constants.html" title="Constants (class)">Constants</a></span></span><span class='period'>.</span><span class='const'><span class='object_link'><a href="Constants.html#ObjectNameMechanicalVentilation-class_method" title="Constants.ObjectNameMechanicalVentilation (method)">ObjectNameMechanicalVentilation</a></span></span>

      <span class='id identifier rubyid_found_mv_energy'>found_mv_energy</span> <span class='op'>=</span> <span class='kw'>true</span>
      <span class='kw'>if</span> <span class='const'><span class='object_link'><a href="XMLHelper.html" title="XMLHelper (class)">XMLHelper</a></span></span><span class='period'>.</span><span class='id identifier rubyid_has_element'><span class='object_link'><a href="XMLHelper.html#has_element-class_method" title="XMLHelper.has_element (method)">has_element</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_mv'>mv</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>AttachedToHVACDistributionSystem</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
        <span class='comment'># CFIS, check for positive mech vent energy
</span>        <span class='id identifier rubyid_assert_operator'>assert_operator</span><span class='lparen'>(</span><span class='id identifier rubyid_results'>results</span><span class='lbracket'>[</span><span class='id identifier rubyid_k'>k</span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='symbol'>:&gt;</span><span class='comma'>,</span> <span class='int'>0</span><span class='rparen'>)</span>
      <span class='kw'>else</span>
        <span class='comment'># Supply, exhaust, ERV, HRV, etc., check for appropriate mech vent energy
</span>        <span class='id identifier rubyid_fan_w'>fan_w</span> <span class='op'>=</span> <span class='const'>Float</span><span class='lparen'>(</span><span class='const'><span class='object_link'><a href="XMLHelper.html" title="XMLHelper (class)">XMLHelper</a></span></span><span class='period'>.</span><span class='id identifier rubyid_get_value'><span class='object_link'><a href="XMLHelper.html#get_value-class_method" title="XMLHelper.get_value (method)">get_value</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_mv'>mv</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>FanPower</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span><span class='rparen'>)</span>
        <span class='id identifier rubyid_hrs_per_day'>hrs_per_day</span> <span class='op'>=</span> <span class='const'>Float</span><span class='lparen'>(</span><span class='const'><span class='object_link'><a href="XMLHelper.html" title="XMLHelper (class)">XMLHelper</a></span></span><span class='period'>.</span><span class='id identifier rubyid_get_value'><span class='object_link'><a href="XMLHelper.html#get_value-class_method" title="XMLHelper.get_value (method)">get_value</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_mv'>mv</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>HoursInOperation</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span><span class='rparen'>)</span>
        <span class='id identifier rubyid_fan_kwhs'>fan_kwhs</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="UnitConversions.html" title="UnitConversions (class)">UnitConversions</a></span></span><span class='period'>.</span><span class='id identifier rubyid_convert'><span class='object_link'><a href="UnitConversions.html#convert-class_method" title="UnitConversions.convert (method)">convert</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_fan_w'>fan_w</span> <span class='op'>*</span> <span class='id identifier rubyid_hrs_per_day'>hrs_per_day</span> <span class='op'>*</span> <span class='float'>365.0</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Wh</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>GJ</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
        <span class='id identifier rubyid_assert_in_delta'>assert_in_delta</span><span class='lparen'>(</span><span class='id identifier rubyid_fan_kwhs'>fan_kwhs</span><span class='comma'>,</span> <span class='id identifier rubyid_results'>results</span><span class='lbracket'>[</span><span class='id identifier rubyid_k'>k</span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='float'>0.1</span><span class='rparen'>)</span>
      <span class='kw'>end</span>
    <span class='kw'>end</span>
    <span class='kw'>if</span> <span class='kw'>not</span> <span class='id identifier rubyid_found_mv_energy'>found_mv_energy</span>
      <span class='id identifier rubyid_flunk'>flunk</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Could not find mechanical ventilation energy for </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_hpxml_path'>hpxml_path</span><span class='embexpr_end'>}</span><span class='tstring_content'>.</span><span class='tstring_end'>&quot;</span></span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_sqlFile'>sqlFile</span><span class='period'>.</span><span class='id identifier rubyid_close'>close</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="_write_summary_results-instance_method">
  
    #<strong>_write_summary_results</strong>(results_dir, results)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


710
711
712
713
714
715
716
717
718
719
720
721
722
723
724
725
726
727
728
729
730
731
732
733
734
735
736
737
738
739
740
741
742
743
744
745
746
747
748
749
750
751
752
753
754
755
756</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'tests/hpxml_translator_test.rb', line 710</span>

<span class='kw'>def</span> <span class='id identifier rubyid__write_summary_results'>_write_summary_results</span><span class='lparen'>(</span><span class='id identifier rubyid_results_dir'>results_dir</span><span class='comma'>,</span> <span class='id identifier rubyid_results'>results</span><span class='rparen'>)</span>
  <span class='const'>Dir</span><span class='period'>.</span><span class='id identifier rubyid_mkdir'>mkdir</span><span class='lparen'>(</span><span class='id identifier rubyid_results_dir'>results_dir</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_csv_out'>csv_out</span> <span class='op'>=</span> <span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_join'>join</span><span class='lparen'>(</span><span class='id identifier rubyid_results_dir'>results_dir</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>results.csv</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>

  <span class='comment'># Get all keys across simulations for output columns
</span>  <span class='id identifier rubyid_output_keys'>output_keys</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>
  <span class='id identifier rubyid_results'>results</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_xml'>xml</span><span class='comma'>,</span> <span class='id identifier rubyid_xml_results'>xml_results</span><span class='op'>|</span>
    <span class='id identifier rubyid_xml_results'>xml_results</span><span class='period'>.</span><span class='id identifier rubyid_keys'>keys</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_key'>key</span><span class='op'>|</span>
      <span class='kw'>next</span> <span class='kw'>if</span> <span class='kw'>not</span> <span class='id identifier rubyid_key'>key</span><span class='period'>.</span><span class='id identifier rubyid_is_a?'>is_a?</span> <span class='const'>Array</span>
      <span class='kw'>next</span> <span class='kw'>if</span> <span class='id identifier rubyid_output_keys'>output_keys</span><span class='period'>.</span><span class='id identifier rubyid_include?'>include?</span> <span class='id identifier rubyid_key'>key</span>

      <span class='id identifier rubyid_output_keys'>output_keys</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_key'>key</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
  <span class='id identifier rubyid_output_keys'>output_keys</span><span class='period'>.</span><span class='id identifier rubyid_sort!'>sort!</span>

  <span class='comment'># Append runtimes at the end
</span>  <span class='id identifier rubyid_output_keys'>output_keys</span> <span class='op'>&lt;&lt;</span> <span class='ivar'>@simulation_runtime_key</span>
  <span class='id identifier rubyid_output_keys'>output_keys</span> <span class='op'>&lt;&lt;</span> <span class='ivar'>@workflow_runtime_key</span>

  <span class='id identifier rubyid_column_headers'>column_headers</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>HPXML</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span>
  <span class='id identifier rubyid_output_keys'>output_keys</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_key'>key</span><span class='op'>|</span>
    <span class='kw'>if</span> <span class='id identifier rubyid_key'>key</span><span class='period'>.</span><span class='id identifier rubyid_is_a?'>is_a?</span> <span class='const'>Array</span>
      <span class='id identifier rubyid_column_headers'>column_headers</span> <span class='op'>&lt;&lt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_key'>key</span><span class='lbracket'>[</span><span class='int'>0</span><span class='rbracket'>]</span><span class='embexpr_end'>}</span><span class='tstring_content'>: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_key'>key</span><span class='lbracket'>[</span><span class='int'>1</span><span class='rbracket'>]</span><span class='embexpr_end'>}</span><span class='tstring_content'>: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_key'>key</span><span class='lbracket'>[</span><span class='int'>2</span><span class='rbracket'>]</span><span class='embexpr_end'>}</span><span class='tstring_content'> [</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_key'>key</span><span class='lbracket'>[</span><span class='int'>3</span><span class='rbracket'>]</span><span class='embexpr_end'>}</span><span class='tstring_content'>]</span><span class='tstring_end'>&quot;</span></span>
    <span class='kw'>else</span>
      <span class='id identifier rubyid_column_headers'>column_headers</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_key'>key</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_require'>require</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>csv</span><span class='tstring_end'>&#39;</span></span>
  <span class='const'>CSV</span><span class='period'>.</span><span class='id identifier rubyid_open'>open</span><span class='lparen'>(</span><span class='id identifier rubyid_csv_out'>csv_out</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>w</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_csv'>csv</span><span class='op'>|</span>
    <span class='id identifier rubyid_csv'>csv</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_column_headers'>column_headers</span>
    <span class='id identifier rubyid_results'>results</span><span class='period'>.</span><span class='id identifier rubyid_sort'>sort</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_xml'>xml</span><span class='comma'>,</span> <span class='id identifier rubyid_xml_results'>xml_results</span><span class='op'>|</span>
      <span class='id identifier rubyid_csv_row'>csv_row</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='id identifier rubyid_xml'>xml</span><span class='rbracket'>]</span>
      <span class='id identifier rubyid_output_keys'>output_keys</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_key'>key</span><span class='op'>|</span>
        <span class='kw'>if</span> <span class='id identifier rubyid_xml_results'>xml_results</span><span class='lbracket'>[</span><span class='id identifier rubyid_key'>key</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span>
          <span class='id identifier rubyid_csv_row'>csv_row</span> <span class='op'>&lt;&lt;</span> <span class='int'>0</span>
        <span class='kw'>else</span>
          <span class='id identifier rubyid_csv_row'>csv_row</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_xml_results'>xml_results</span><span class='lbracket'>[</span><span class='id identifier rubyid_key'>key</span><span class='rbracket'>]</span>
        <span class='kw'>end</span>
      <span class='kw'>end</span>
      <span class='id identifier rubyid_csv'>csv</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_csv_row'>csv_row</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_puts'>puts</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Wrote results to </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_csv_out'>csv_out</span><span class='embexpr_end'>}</span><span class='tstring_content'>.</span><span class='tstring_end'>&quot;</span></span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="test_simulations-instance_method">
  
    #<strong>test_simulations</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'tests/hpxml_translator_test.rb', line 15</span>

<span class='kw'>def</span> <span class='id identifier rubyid_test_simulations'>test_simulations</span>
  <span class='const'>OpenStudio</span><span class='op'>::</span><span class='const'>Logger</span><span class='period'>.</span><span class='id identifier rubyid_instance'>instance</span><span class='period'>.</span><span class='id identifier rubyid_standardOutLogger'>standardOutLogger</span><span class='period'>.</span><span class='id identifier rubyid_setLogLevel'>setLogLevel</span><span class='lparen'>(</span><span class='const'>OpenStudio</span><span class='op'>::</span><span class='const'>Error</span><span class='rparen'>)</span>
  <span class='comment'># OpenStudio::Logger.instance.standardOutLogger.setLogLevel(OpenStudio::Fatal)
</span>
  <span class='id identifier rubyid_this_dir'>this_dir</span> <span class='op'>=</span> <span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_dirname'>dirname</span><span class='lparen'>(</span><span class='kw'>__FILE__</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_results_dir'>results_dir</span> <span class='op'>=</span> <span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_join'>join</span><span class='lparen'>(</span><span class='id identifier rubyid_this_dir'>this_dir</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>results</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
  <span class='id identifier rubyid__rm_path'>_rm_path</span><span class='lparen'>(</span><span class='id identifier rubyid_results_dir'>results_dir</span><span class='rparen'>)</span>

  <span class='id identifier rubyid_args'>args</span> <span class='op'>=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span>
  <span class='id identifier rubyid_args'>args</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>weather_dir</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_absolute_path'>absolute_path</span><span class='lparen'>(</span><span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_join'>join</span><span class='lparen'>(</span><span class='id identifier rubyid_this_dir'>this_dir</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>..</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>weather</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_args'>args</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>skip_validation</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='kw'>false</span>

  <span class='ivar'>@simulation_runtime_key</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Simulation Runtime</span><span class='tstring_end'>&quot;</span></span>
  <span class='ivar'>@workflow_runtime_key</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Workflow Runtime</span><span class='tstring_end'>&quot;</span></span>

  <span class='id identifier rubyid_cfis_dir'>cfis_dir</span> <span class='op'>=</span> <span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_absolute_path'>absolute_path</span><span class='lparen'>(</span><span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_join'>join</span><span class='lparen'>(</span><span class='id identifier rubyid_this_dir'>this_dir</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>cfis</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_hvac_dse_dir'>hvac_dse_dir</span> <span class='op'>=</span> <span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_absolute_path'>absolute_path</span><span class='lparen'>(</span><span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_join'>join</span><span class='lparen'>(</span><span class='id identifier rubyid_this_dir'>this_dir</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>hvac_dse</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_hvac_multiple_dir'>hvac_multiple_dir</span> <span class='op'>=</span> <span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_absolute_path'>absolute_path</span><span class='lparen'>(</span><span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_join'>join</span><span class='lparen'>(</span><span class='id identifier rubyid_this_dir'>this_dir</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>hvac_multiple</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_hvac_partial_dir'>hvac_partial_dir</span> <span class='op'>=</span> <span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_absolute_path'>absolute_path</span><span class='lparen'>(</span><span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_join'>join</span><span class='lparen'>(</span><span class='id identifier rubyid_this_dir'>this_dir</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>hvac_partial</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_hvac_load_fracs_dir'>hvac_load_fracs_dir</span> <span class='op'>=</span> <span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_absolute_path'>absolute_path</span><span class='lparen'>(</span><span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_join'>join</span><span class='lparen'>(</span><span class='id identifier rubyid_this_dir'>this_dir</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>hvac_load_fracs</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_autosize_dir'>autosize_dir</span> <span class='op'>=</span> <span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_absolute_path'>absolute_path</span><span class='lparen'>(</span><span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_join'>join</span><span class='lparen'>(</span><span class='id identifier rubyid_this_dir'>this_dir</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>hvac_autosizing</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span><span class='rparen'>)</span>

  <span class='id identifier rubyid_test_dirs'>test_dirs</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='id identifier rubyid_this_dir'>this_dir</span><span class='comma'>,</span>
               <span class='id identifier rubyid_cfis_dir'>cfis_dir</span><span class='comma'>,</span>
               <span class='id identifier rubyid_hvac_dse_dir'>hvac_dse_dir</span><span class='comma'>,</span>
               <span class='id identifier rubyid_hvac_multiple_dir'>hvac_multiple_dir</span><span class='comma'>,</span>
               <span class='id identifier rubyid_hvac_partial_dir'>hvac_partial_dir</span><span class='comma'>,</span>
               <span class='id identifier rubyid_hvac_load_fracs_dir'>hvac_load_fracs_dir</span><span class='comma'>,</span>
               <span class='id identifier rubyid_autosize_dir'>autosize_dir</span><span class='rbracket'>]</span>

  <span class='id identifier rubyid_xmls'>xmls</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>
  <span class='id identifier rubyid_test_dirs'>test_dirs</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_test_dir'>test_dir</span><span class='op'>|</span>
    <span class='const'>Dir</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_test_dir'>test_dir</span><span class='embexpr_end'>}</span><span class='tstring_content'>/valid*.xml</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_sort'>sort</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_xml'>xml</span><span class='op'>|</span>
      <span class='id identifier rubyid_xmls'>xmls</span> <span class='op'>&lt;&lt;</span> <span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_absolute_path'>absolute_path</span><span class='lparen'>(</span><span class='id identifier rubyid_xml'>xml</span><span class='rparen'>)</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>

  <span class='comment'># Test simulations
</span>  <span class='id identifier rubyid_puts'>puts</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Running </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_xmls'>xmls</span><span class='period'>.</span><span class='id identifier rubyid_size'>size</span><span class='embexpr_end'>}</span><span class='tstring_content'> HPXML files...</span><span class='tstring_end'>&quot;</span></span>
  <span class='id identifier rubyid_all_results'>all_results</span> <span class='op'>=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span>
  <span class='id identifier rubyid_xmls'>xmls</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_xml'>xml</span><span class='op'>|</span>
    <span class='id identifier rubyid_all_results'>all_results</span><span class='lbracket'>[</span><span class='id identifier rubyid_xml'>xml</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid__run_xml'>_run_xml</span><span class='lparen'>(</span><span class='id identifier rubyid_xml'>xml</span><span class='comma'>,</span> <span class='id identifier rubyid_this_dir'>this_dir</span><span class='comma'>,</span> <span class='id identifier rubyid_args'>args</span><span class='period'>.</span><span class='id identifier rubyid_dup'>dup</span><span class='rparen'>)</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid__write_summary_results'>_write_summary_results</span><span class='lparen'>(</span><span class='id identifier rubyid_results_dir'>results_dir</span><span class='comma'>,</span> <span class='id identifier rubyid_all_results'>all_results</span><span class='rparen'>)</span>

  <span class='comment'># Cross simulation tests
</span>  <span class='id identifier rubyid__test_dse'>_test_dse</span><span class='lparen'>(</span><span class='id identifier rubyid_xmls'>xmls</span><span class='comma'>,</span> <span class='id identifier rubyid_hvac_dse_dir'>hvac_dse_dir</span><span class='comma'>,</span> <span class='id identifier rubyid_all_results'>all_results</span><span class='rparen'>)</span>
  <span class='id identifier rubyid__test_multiple_hvac'>_test_multiple_hvac</span><span class='lparen'>(</span><span class='id identifier rubyid_xmls'>xmls</span><span class='comma'>,</span> <span class='id identifier rubyid_hvac_multiple_dir'>hvac_multiple_dir</span><span class='comma'>,</span> <span class='id identifier rubyid_all_results'>all_results</span><span class='rparen'>)</span>
  <span class='id identifier rubyid__test_partial_hvac'>_test_partial_hvac</span><span class='lparen'>(</span><span class='id identifier rubyid_xmls'>xmls</span><span class='comma'>,</span> <span class='id identifier rubyid_hvac_partial_dir'>hvac_partial_dir</span><span class='comma'>,</span> <span class='id identifier rubyid_all_results'>all_results</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

</div>

      <div id="footer">
  Generated on Tue Jan  8 16:00:22 2019 by
  <a href="http://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.9.16 (ruby-2.2.6).
</div>

    </div>
  </body>
</html>